# Bitbucket Pipe for Shipgate ISL Verify
#
# Usage:
#   - pipe: shipgate/isl-verify:1.0.0
#     variables:
#       PATH: 'src/'
#       FAIL_ON: 'error'
#       MODE: 'auto'
#       CONFIG: '.shipgate.yml'

image: ghcr.io/shipgate/shipgate:v1

script:
  - |
    shipgate verify "${PATH:-src/}" \
      --ci \
      --format junit \
      --fail-on "${FAIL_ON:-error}" \
      > test-reports/shipgate.xml
  - pipe: atlassian/upload-test-results:0.1.0
    variables:
      FILES: 'test-reports/shipgate.xml'
