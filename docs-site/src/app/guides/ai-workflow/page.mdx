export const metadata = {
  title: 'AI Code Review Workflow - ISL Verify',
  description: 'Verify Cursor/Copilot generated code automatically',
}

# Working with Cursor/Copilot

ISL Verify catches AI hallucinations: imports that don't exist, missing auth checks, unsafe SQL queries, and other mistakes AI models make.

---

## Recommended Workflow

### 1. AI Generates Code

Use Cursor, GitHub Copilot, or Claude to write features:

```
You: "Add a POST /api/orders endpoint that creates an order for the authenticated user"

AI: *generates 50 lines of code*
```

### 2. Commit and Push

```bash
git add .
git commit -m "feat: add order creation endpoint"
git push origin feature/orders
```

### 3. CI Runs ISL Verify

Your GitHub Action automatically scans the PR and comments with findings.

### 4. Fix or Accept Risk

Either fix the code or add to `.isl-verify-ignore.json` with justification.

---

## Common AI Hallucinations

### Hallucinated Imports

**AI generates:**
```typescript
import { validateOrder } from '@/lib/validation'  // doesn't exist
```

**ISL Verify catches:**
```
✗ Import Integrity: 2/127 imports unresolved
  - @/lib/validation: module not found
```

### Missing Auth Checks

**AI generates:**
```typescript
export async function POST(req: NextRequest) {
  const body = await req.json()
  const order = await db.order.create({ data: body })  // No auth!
  return NextResponse.json(order)
}
```

**ISL Verify catches:**
```
✗ Auth Coverage: POST /api/orders has no auth check
```

**Fix:**
```typescript
export async function POST(req: NextRequest) {
  const session = await getServerSession()
  if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  
  const body = await req.json()
  const order = await db.order.create({ 
    data: { ...body, userId: session.user.id }
  })
  return NextResponse.json(order)
}
```

---

## Pre-Commit Hook (Optional)

```bash
# .husky/pre-commit
npx @isl-lang/isl-verify . --quick --fail-on FAILED
```

---

## Trust Scores

| Score | Verdict | Action |
|-------|---------|--------|
| 90-100 | VERIFIED | ✅ Merge with confidence |
| 70-89 | PARTIAL | ⚠️ Review warnings |
| 50-69 | PARTIAL | ⚠️ Manual review required |
| 0-49 | INSUFFICIENT | ❌ Fix critical issues |

---

## Next Steps

<div className="grid gap-4 mt-6">
  <a href="/guides/custom-provers" className="block p-4 border rounded-lg hover:bg-accent transition">
    <div className="font-semibold">Write Custom Provers</div>
    <div className="text-sm text-muted-foreground">Add project-specific verification</div>
  </a>
  
  <a href="/properties" className="block p-4 border rounded-lg hover:bg-accent transition">
    <div className="font-semibold">Property Reference</div>
    <div className="text-sm text-muted-foreground">All available properties</div>
  </a>
</div>
