# Shipgate v0.1 — Shippable Core

> **Status**: FROZEN  
> **Date**: 2026-02-01  
> **Goal**: SHIP/NO_SHIP verdicts with tamper-proof evidence

---

## What v0.1 IS

### Core Gate (`@isl-lang/gate`)
- [x] `isl gate` runs on changed files by default
- [x] Returns `SHIP` or `NO_SHIP` verdict
- [x] Score 0-100 with reasons
- [x] Deterministic fingerprint (same inputs → same hash)
- [x] Critical blocker detection

### Evidence Bundle (`@isl-lang/evidence`)
- [x] Always emits `manifest.json` + `results.json` + `report.html`
- [x] Deterministic mode (no timestamps, stable ordering)
- [ ] **TODO**: SHA-256 signing of manifest
- [ ] **TODO**: Integrity verification

### Firewall (`@isl-lang/firewall`)
- [x] Claim extraction (API endpoints, env vars, imports, files)
- [x] Evidence resolution against truthpack
- [x] Policy evaluation (ghost-route, ghost-env, etc.)
- [x] Allowlist management
- [x] Modes: observe / enforce / lockdown

### Adapters (`@isl-lang/adapters`)
- [x] GitHub Action: posts PR summary + uploads evidence
- [x] MCP tools: `isl_gate_run` + `isl_evidence_read`
- [x] CLI: `isl gate` command

### Policy Packs (`@isl-lang/policy-packs`)
- [x] Registry with enable/disable per pack
- [x] Severity override per rule
- [x] Built-in packs: auth, payments, pii, rate-limit

---

## What v0.1 is NOT

These are explicitly out of scope for v0.1:

| Feature | Status | When |
|---------|--------|------|
| Auto-fix / code generation | ❌ Later | v0.3+ |
| LLM-powered analysis | ❌ Later | v0.2+ |
| Runtime proof collection | ❌ Later | v0.2+ |
| ISL spec parsing integration | ❌ Later | v0.2 |
| Custom policy YAML/DSL | ❌ Later | v0.2 |
| Dashboard / web UI | ❌ Later | v0.3+ |
| Multi-repo analysis | ❌ Later | v0.3+ |
| Secrets scanning | ❌ Later | v0.2 |
| SBOM generation | ❌ Later | v0.3+ |

---

## v0.1 Deliverables

### 1. Packages (npm)
```
@isl-lang/gate           # Core verdict logic
@isl-lang/evidence       # Evidence bundle writer
@isl-lang/firewall       # Agent firewall
@isl-lang/adapters       # GitHub/MCP/CLI adapters
@isl-lang/policy-packs   # Pre-built security policies
@isl-lang/verified-build # Single-package SDK for integrators
```

### 2. CLI Commands
```bash
isl gate              # Run gate on current directory
isl gate --changed    # Only changed files (default)
isl gate --all        # All files
isl gate --strict     # Exit 1 on NO_SHIP
isl demo              # Clone demo repo + run gate
```

### 3. GitHub Action
```yaml
- uses: isl-lang/gate@v0.1
  with:
    mode: check           # or 'enforce'
    fail-on: no_ship
    upload-evidence: true
```

### 4. MCP Tools
```
isl_gate_run          # Run gate, return verdict
isl_evidence_read     # Read evidence bundle
isl_firewall_check    # Quick allow/deny check
```

### 5. Configuration
```json
// .shipgate/config.json
{
  "version": "0.1",
  "gate": {
    "changedOnly": true,
    "strict": false
  },
  "policyPacks": {
    "auth": { "enabled": true },
    "payments": { "enabled": true },
    "pii": { "enabled": true },
    "rate-limit": { "enabled": true }
  },
  "evidence": {
    "outputDir": ".shipgate/evidence",
    "sign": true
  }
}
```

---

## Success Criteria

v0.1 ships when:

1. **Gate works**: `isl gate` returns SHIP/NO_SHIP in < 5 seconds
2. **Evidence is tamper-proof**: SHA-256 fingerprint, verifiable
3. **GitHub Action works**: PR comment + status check + artifact
4. **Demo converts**: `isl demo` creates instant understanding
5. **77+ tests pass**: All existing tests green
6. **Docs exist**: 5-minute quickstart

---

## Non-Bypassable Gate (Enterprise Mode)

For protected branches, the gate MUST be non-bypassable:

```yaml
# .github/workflows/isl-gate.yml
name: ISL Gate (Required)
on:
  pull_request:
    branches: [main, production]

jobs:
  gate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: isl-lang/gate@v0.1
        with:
          mode: enforce
          fail-on: no_ship
```

**Protected branch settings**:
- Require status checks: `ISL Gate (Required)`
- Require branches to be up to date
- No bypass for admins

**Evidence chain**:
1. Gate runs → produces `fingerprint`
2. Fingerprint signed → stored in artifact
3. Merge requires passing gate
4. Post-merge: fingerprint logged to audit

---

## Timeline

| Week | Milestone |
|------|-----------|
| W1 | Deterministic evidence + signing |
| W1 | Demo repo (3 branches) |
| W2 | `isl demo` command |
| W2 | `@isl-lang/verified-build` SDK |
| W3 | GitHub Action polish |
| W3 | Documentation |
| W4 | npm publish + announce |

---

## Open Questions

1. **Signing**: Use project-local key or external KMS?
2. **Config location**: `.shipgate/` vs `.isl/` vs root?
3. **Demo hosting**: GitHub template repo or embedded?
