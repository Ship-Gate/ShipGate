<p align="center">
  <strong>shipgate</strong> — the last gate before production for AI-written code.
</p>

<p align="center">
  <a href="https://badge.fury.io/js/shipgate"><img src="https://badge.fury.io/js/shipgate.svg" alt="npm version"></a>
  <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT"></a>
  <a href="https://github.com/Ship-Gate/ShipGate/actions"><img src="https://github.com/Ship-Gate/ShipGate/actions/workflows/shipgate.yml/badge.svg" alt="CI"></a>
</p>

<p align="center">
  <img src="https://vhs.charm.sh/vhs-2kRF2qC1pB5NkxepJTpOCu.gif" alt="ShipGate terminal demo — vibe, scan, gate" width="900">
</p>

---

## The Problem

AI coding assistants generate code that compiles, passes linting, and looks correct — but:

- **Ghost routes** — API endpoints referenced in code that don't exist in your spec
- **Ghost env vars** — `process.env.STRIPE_KEY` accessed but never declared or configured
- **Auth bypasses** — Public endpoints that should require authentication but don't

Linters can't catch these. Tests can't catch what they don't know to test. You need a behavioral gate.

## How It Works

```
Your intent (NL or ISL)  →  Behavioral contract  →  SHIP or NO_SHIP
                                                      with evidence
```

1. **Define intent** — Write ISL specs by hand, or describe what you want in plain English
2. **Verify code** — ShipGate checks implementation against the behavioral contract
3. **Gate the merge** — SHIP (exit 0) or NO_SHIP (exit 1) with a tamper-proof evidence bundle

## Quick Start

```bash
npm install -g shipgate

# One command — detect, init, infer ISL, verify, gate:
shipgate go

# Or go from natural language to a verified project in one shot:
shipgate vibe "build a todo API with auth and JWT"
```

## Commands

| Command | What it does |
|---------|-------------|
| `shipgate go [path]` | **One command to gate anything.** Detect → init → infer ISL → verify → gate. |
| `shipgate go --fix` | Go + auto-heal violations |
| `shipgate go --deep` | Go with thorough scan |
| `shipgate vibe "<prompt>"` | NL → ISL spec → full-stack code → verify → SHIP/NO_SHIP |
| `shipgate vibe "<prompt>" --lang python` | Vibe in Python, Rust, Go, or TypeScript |
| `shipgate scan <path>` | Scan a codebase, AI-generate ISL specs, produce coverage report |
| `shipgate verify <path>` | Verify implementation against specs. Detailed results + evidence |
| `shipgate gate <spec> --impl <path>` | Binary SHIP/NO_SHIP verdict. Use in CI with `--ci` |
| `shipgate gen ts <file.isl>` | Generate TypeScript from ISL (also: python, rust, go, graphql, openapi) |
| `shipgate heal <path>` | AI-powered auto-fix for spec violations |
| `shipgate policy list` | Show all 27 policy rules with severity and remediation hints |

## Why ISL?

ISL (Intent Specification Language) captures *what your code must do* — preconditions, postconditions, invariants — not just what it looks like. It's the contract AI must satisfy.

```isl
domain PaymentService {
  behavior ChargeCard {
    preconditions  { input.amount > 0  }
    postconditions { success implies Payment.exists({ id: result.paymentId }) }
  }
}
```

## Ship Score

Every verification produces a **Ship Score** (0–100) based on spec coverage, policy compliance, and verification depth. `SHIP` requires >= 70. Below that: `NO_SHIP` with a list of exactly what to fix.

## CI Integration

Add to any GitHub Actions workflow:

```yaml
- name: ShipGate
  run: npx shipgate go . --ci
```

Or use the full workflow generated by `shipgate init`, which uploads evidence bundles as artifacts and posts verdict comments on PRs.

## Dashboard

The ShipGate dashboard (`packages/shipgate-dashboard`) is a full Next.js 14 web application with:

- **GitHub/Google OAuth** login with cookie-based sessions
- **RBAC** — admin, member, viewer roles per organization
- **GitHub integration** — Connect GitHub accounts, view repos, PRs, and commits directly in the dashboard
- **Slack integration** — Connect a Slack workspace and configure notification rules (channel + event type)
- **Deployment tracking** — Webhook-based integration with Vercel and Railway; real-time deployment status feed
- **Overview dashboard** — Sparkline trend charts on stat cards, verdict breakdown donut chart, activity feed, and integration status strip
- **Vibe pipeline** — Run NL → ISL → verified code from the browser
- **Stripe billing** — Pro subscription gating with checkout flow
- **Audit logging** — All actions logged with IP, user agent, request ID

```bash
cd packages/shipgate-dashboard
cp .env.example .env.local   # Add your OAuth + integration credentials
pnpm dev
# Open http://localhost:3001
```

See `packages/shipgate-dashboard/.env.example` for all required environment variables including GitHub OAuth, Google OAuth, Stripe, Slack, and token encryption keys.

## VS Code Extension

Install from the VS Code Marketplace or build from source:

```bash
ext install shipgate.shipgate-isl
```

The sidebar gives you one-click access to every command:

- **Actions** panel — buttons for Go, Vibe, Scan, Gen, Heal
- **Overview** — animated ship score, coverage stats, verdict
- **Files** — per-file pass/warn/fail breakdown
- **Claims** — individual spec claim verification status
- **Pipeline** — CI run history and environment details

Keyboard shortcuts: `Cmd+Shift+Enter` for `shipgate go`, `Cmd+Shift+V` for Vibe.

## MCP / AI Firewall

ShipGate runs as an MCP server that intercepts AI suggestions in real time:

```json
{
  "mcpServers": {
    "shipgate": {
      "command": "npx",
      "args": ["-y", "shipgate-mcp"]
    }
  }
}
```

Every suggestion is checked against your Truthpack (routes, env vars, auth rules) and 27 policy rules. Ghost routes get `BLOCK`. Missing auth gets `WARN`. Clean code gets `ALLOW`.

## Multi-Language Codegen

Generate from ISL specs or from natural language — 6 targets:

```bash
shipgate gen ts auth.isl           # TypeScript
shipgate gen python auth.isl       # Python (Pydantic, pytest)
shipgate gen rust auth.isl         # Rust (Serde, traits)
shipgate gen go auth.isl           # Go (structs, interfaces)
shipgate gen graphql auth.isl      # GraphQL schema
shipgate gen openapi auth.isl      # OpenAPI 3.0

shipgate vibe "REST API" --lang python   # NL → Python project
shipgate vibe "REST API" --lang rust     # NL → Rust project
```

## Architecture

ShipGate is a monorepo (pnpm workspaces + Turborepo) with **248 packages** across **1.1M+ lines of source code**.

### Package Categories

| Category | Count | Examples |
|----------|-------|---------|
| **Core engine** | ~10 | `core` (62k lines), `cli` (46k lines), `evaluator`, `interpreter`, `errors` |
| **ISL language** | 38 | `isl-core`, `isl-gate`, `isl-pipeline`, `isl-compiler`, `isl-proof`, `isl-pbt`, `isl-healer` |
| **Code generation** | 30 | `codegen-types`, `codegen-graphql`, `codegen-grpc`, `codegen-terraform`, `codegen-python`, `codegen-rust`, `codegen-go`, `codegen-wasm` |
| **Standard library** | 31 | `stdlib-payments` (10k lines), `stdlib-rate-limit` (7k), `stdlib-queue`, `stdlib-cache`, `stdlib-auth`, `stdlib-billing`, `stdlib-workflow`, `stdlib-saas` |
| **Verifiers** | 6 | `verifier-chaos` (11k), `verifier-temporal` (10k), `verifier-formal` (7k), `verifier-security`, `verifier-sandbox` |
| **SDKs** | 8 | `sdk-flutter` (Dart, 6k), `sdk-kotlin` (6k), `sdk-swift` (4k), `sdk-python` (3k), `sdk-typescript`, `sdk-web`, `sdk-react-native` |
| **Security** | ~8 | `security-scanner` (7k), `security-policies` (5k), `secrets-hygiene`, `hallucination-scanner`, `fake-success-ui-detector` |
| **Infrastructure** | ~20 | `distributed`, `event-sourcing`, `circuit-breaker`, `api-gateway`, `api-versioning`, `edge-runtime`, `streaming` |
| **Dashboard** | 3 | `shipgate-dashboard` (11k), `dashboard-api`, `marketplace-web` |
| **Tooling** | ~15 | `test-generator` (13k), `mutation-testing`, `snapshot-testing`, `formal-verification`, `prover`, `typechecker` |

### Top 10 Packages by Size

| Package | Lines | Purpose |
|---------|-------|---------|
| `core` | 61,830 | Central verification engine, spec processing, rule evaluation |
| `cli` | 46,174 | Full CLI: go, vibe, scan, verify, gate, gen, heal, policy |
| `test-generator` | 13,236 | Generates executable tests from ISL specs |
| `isl-gate` | 12,512 | SHIP/NO_SHIP gate engine with trust scoring |
| `isl-healer` | 11,565 | AI-powered auto-fix for spec violations |
| `shipgate-dashboard` | 11,300 | Next.js web dashboard with integrations |
| `isl-expression-evaluator` | 11,383 | Evaluates ISL postconditions against real values |
| `isl-pipeline` | 11,253 | Orchestrates the full verification pipeline |
| `verifier-chaos` | 10,771 | Chaos testing with fault injection |
| `isl-pbt` | 10,264 | Property-based testing engine |

## Project Structure

| Path | Purpose |
|------|---------|
| `packages/` | 248 packages — the full platform |
| `packages/shipgate-dashboard/` | Next.js 14 web dashboard |
| `packages/core/` | Core verification engine |
| `packages/cli/` | CLI binary (`shipgate`) |
| `docs/` | 146 documentation files |
| `samples/` | ISL spec samples and tutorials |
| `demos/` | Demo projects and showcases |
| `stdlib/` | ISL standard library definitions |
| `.shipgate.yml` | Config: CI behavior, ignore patterns, thresholds |
| `.shipgate/specs/` | ISL specifications |
| `.shipgate/evidence/` | Evidence bundles per verification run |
| `.shipgate/truthpack/` | Auto-extracted routes, env vars, auth rules |

## Links

- [Docs](https://shipgate.dev/docs) — Full documentation
- [ISL Reference](https://shipgate.dev/docs/isl) — Language specification
- [GitHub](https://github.com/Ship-Gate/ShipGate) — Source code
- [npm](https://www.npmjs.com/package/shipgate) — Package registry

## License

MIT
