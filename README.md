<p align="center">
  <strong>shipgate</strong> — the last gate before production for AI-written code.
</p>

<p align="center">
  <a href="https://badge.fury.io/js/shipgate"><img src="https://badge.fury.io/js/shipgate.svg" alt="npm version"></a>
  <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT"></a>
  <a href="https://github.com/Ship-Gate/ShipGate/actions"><img src="https://github.com/Ship-Gate/ShipGate/actions/workflows/shipgate.yml/badge.svg" alt="CI"></a>
</p>

<p align="center">
  <img src="https://vhs.charm.sh/vhs-2kRF2qC1pB5NkxepJTpOCu.gif" alt="ShipGate terminal demo — vibe, scan, gate" width="900">
</p>

---

## The Problem

AI coding assistants generate code that compiles, passes linting, and looks correct — but:

- **Ghost routes** — API endpoints referenced in code that don't exist in your spec
- **Ghost env vars** — `process.env.STRIPE_KEY` accessed but never declared or configured
- **Auth bypasses** — Public endpoints that should require authentication but don't

Linters can't catch these. Tests can't catch what they don't know to test. You need a behavioral gate.

## How It Works

```
Your intent (NL or ISL)  →  Behavioral contract  →  SHIP or NO_SHIP
                                                      with evidence
```

1. **Define intent** — Write ISL specs by hand, or describe what you want in plain English
2. **Verify code** — shipgate checks implementation against the behavioral contract
3. **Gate the merge** — SHIP (exit 0) or NO_SHIP (exit 1) with a tamper-proof evidence bundle

## Quick Start

```bash
npm install -g shipgate
shipgate init
shipgate verify src/
shipgate gate specs/auth.isl --impl src/ --ci
```

Or go from natural language to a verified project in one shot:

```bash
shipgate vibe "build a todo API with auth and JWT"
```

## Commands

| Command | What it does |
|---------|-------------|
| `shipgate init` | Scaffold `.shipgate.yml`, specs dir, CI workflow |
| `shipgate vibe "<prompt>"` | NL → ISL spec → full-stack code → verify → SHIP/NO_SHIP |
| `shipgate scan <path>` | Scan any codebase, generate ISL specs, produce coverage report |
| `shipgate verify <path>` | Verify implementation against specs. Detailed results + evidence |
| `shipgate gate <spec> --impl <path>` | Binary SHIP/NO_SHIP verdict. Use in CI with `--ci` |
| `shipgate policy list` | Show all 27 policy rules with severity and remediation hints |

## Why ISL?

ISL (Intent Specification Language) captures *what your code must do* — preconditions, postconditions, invariants — not just what it looks like. It's the contract AI must satisfy.

## Ship Score

Every verification produces a **Ship Score** (0–100) based on spec coverage, policy compliance, and verification depth. `SHIP` requires >= 70. Below that: `NO_SHIP` with a list of exactly what to fix.

## CI Integration

Add to any GitHub Actions workflow:

```yaml
- name: ShipGate
  run: |
    npx shipgate verify . --ci --format github
    npx shipgate gate specs/ --impl src/ --ci
```

Or use the full workflow generated by `shipgate init`, which uploads evidence bundles as artifacts and posts verdict comments on PRs.

## MCP / AI Firewall

shipgate runs as an MCP server that intercepts AI suggestions in real time:

```json
{
  "mcpServers": {
    "shipgate": {
      "command": "npx",
      "args": ["-y", "shipgate-mcp"]
    }
  }
}
```

Every suggestion is checked against your Truthpack (routes, env vars, auth rules) and 27 policy rules. Ghost routes get `BLOCK`. Missing auth gets `WARN`. Clean code gets `ALLOW`.

## Multi-Language Codegen

```bash
shipgate vibe "REST API for user management" --lang typescript  # default
shipgate vibe "REST API for user management" --lang python      # FastAPI + pytest
shipgate vibe "REST API for user management" --lang rust        # Axum + cargo
shipgate vibe "REST API for user management" --lang go          # Gin + go test
```

## Project Structure

| Path | Purpose |
|------|---------|
| `.shipgate.yml` | Config: CI behavior, ignore patterns, thresholds |
| `.shipgate/specs/` | ISL specifications |
| `.shipgate/evidence/` | Evidence bundles per verification run |
| `.shipgate/truthpack/` | Auto-extracted routes, env vars, auth rules |

## Links

- [Docs](https://shipgate.dev/docs) — Full documentation
- [ISL Reference](https://shipgate.dev/docs/isl) — Language specification
- [GitHub](https://github.com/Ship-Gate/ShipGate) — Source code
- [npm](https://www.npmjs.com/package/shipgate) — Package registry

## License

MIT
