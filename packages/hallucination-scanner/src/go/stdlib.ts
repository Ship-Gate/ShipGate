/**
 * Go standard library package list
 * Source: https://pkg.go.dev/std (Go 1.22)
 *
 * @module @isl-lang/hallucination-scanner/go
 */

/**
 * Complete set of Go standard library packages.
 * Includes top-level and nested packages.
 */
export const GO_STDLIB_PACKAGES: ReadonlySet<string> = new Set([
  // Top-level
  'archive/tar',
  'archive/zip',
  'bufio',
  'bytes',
  'cmp',
  'compress/bzip2',
  'compress/flate',
  'compress/gzip',
  'compress/lzw',
  'compress/zlib',
  'container/heap',
  'container/list',
  'container/ring',
  'context',
  'crypto',
  'crypto/aes',
  'crypto/cipher',
  'crypto/des',
  'crypto/dsa',
  'crypto/ecdh',
  'crypto/ecdsa',
  'crypto/ed25519',
  'crypto/elliptic',
  'crypto/hmac',
  'crypto/md5',
  'crypto/rand',
  'crypto/rc4',
  'crypto/rsa',
  'crypto/sha1',
  'crypto/sha256',
  'crypto/sha512',
  'crypto/subtle',
  'crypto/tls',
  'crypto/x509',
  'crypto/x509/pkix',
  'database/sql',
  'database/sql/driver',
  'debug/buildinfo',
  'debug/dwarf',
  'debug/elf',
  'debug/gosym',
  'debug/macho',
  'debug/pe',
  'debug/plan9obj',
  'embed',
  'encoding',
  'encoding/ascii85',
  'encoding/asn1',
  'encoding/base32',
  'encoding/base64',
  'encoding/binary',
  'encoding/csv',
  'encoding/gob',
  'encoding/hex',
  'encoding/json',
  'encoding/pem',
  'encoding/xml',
  'errors',
  'expvar',
  'flag',
  'fmt',
  'go/ast',
  'go/build',
  'go/build/constraint',
  'go/constant',
  'go/doc',
  'go/doc/comment',
  'go/format',
  'go/importer',
  'go/parser',
  'go/printer',
  'go/scanner',
  'go/token',
  'go/types',
  'hash',
  'hash/adler32',
  'hash/crc32',
  'hash/crc64',
  'hash/fnv',
  'hash/maphash',
  'html',
  'html/template',
  'image',
  'image/color',
  'image/color/palette',
  'image/draw',
  'image/gif',
  'image/jpeg',
  'image/png',
  'index/suffixarray',
  'io',
  'io/fs',
  'io/ioutil',
  'iter',
  'log',
  'log/slog',
  'log/syslog',
  'maps',
  'math',
  'math/big',
  'math/bits',
  'math/cmplx',
  'math/rand',
  'math/rand/v2',
  'mime',
  'mime/multipart',
  'mime/quotedprintable',
  'net',
  'net/http',
  'net/http/cgi',
  'net/http/cookiejar',
  'net/http/fcgi',
  'net/http/httptest',
  'net/http/httptrace',
  'net/http/httputil',
  'net/http/pprof',
  'net/mail',
  'net/netip',
  'net/rpc',
  'net/rpc/jsonrpc',
  'net/smtp',
  'net/textproto',
  'net/url',
  'os',
  'os/exec',
  'os/signal',
  'os/user',
  'path',
  'path/filepath',
  'plugin',
  'reflect',
  'regexp',
  'regexp/syntax',
  'runtime',
  'runtime/cgo',
  'runtime/coverage',
  'runtime/debug',
  'runtime/metrics',
  'runtime/pprof',
  'runtime/race',
  'runtime/trace',
  'slices',
  'sort',
  'strconv',
  'strings',
  'structs',
  'sync',
  'sync/atomic',
  'syscall',
  'testing',
  'testing/fstest',
  'testing/iotest',
  'testing/quick',
  'testing/slogtest',
  'text/scanner',
  'text/tabwriter',
  'text/template',
  'text/template/parse',
  'time',
  'time/tzdata',
  'unicode',
  'unicode/utf16',
  'unicode/utf8',
  'unsafe',
]);

/**
 * Top-level Go stdlib package prefixes.
 * Used for quick prefix matching when a nested path might match stdlib.
 */
export const GO_STDLIB_TOP_LEVEL: ReadonlySet<string> = new Set([
  'archive',
  'bufio',
  'bytes',
  'cmp',
  'compress',
  'container',
  'context',
  'crypto',
  'database',
  'debug',
  'embed',
  'encoding',
  'errors',
  'expvar',
  'flag',
  'fmt',
  'go',
  'hash',
  'html',
  'image',
  'index',
  'io',
  'iter',
  'log',
  'maps',
  'math',
  'mime',
  'net',
  'os',
  'path',
  'plugin',
  'reflect',
  'regexp',
  'runtime',
  'slices',
  'sort',
  'strconv',
  'strings',
  'structs',
  'sync',
  'syscall',
  'testing',
  'text',
  'time',
  'unicode',
  'unsafe',
]);

/**
 * Check if an import path is a Go standard library package.
 * Exact match against the known stdlib set.
 */
export function isGoStdlib(importPath: string): boolean {
  return GO_STDLIB_PACKAGES.has(importPath);
}

/**
 * Check if an import path *could* be stdlib based on the top-level prefix.
 * Useful for distinguishing potentially-misspelled stdlib paths from external modules.
 */
export function hasStdlibPrefix(importPath: string): boolean {
  const first = importPath.split('/')[0];
  return GO_STDLIB_TOP_LEVEL.has(first ?? '');
}
