"use strict";(()=>{var e={};e.id=976,e.ids=[976],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},2842:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>v,staticGenerationAsyncStorage:()=>d});var i={};t.r(i),t.d(i,{POST:()=>p});var s=t(2070),o=t(1566),n=t(4585),a=t(7481),u=t(1876);async function p(e){try{let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return a.NextResponse.json({error:"Missing or invalid authorization header"},{status:401});let t=r.substring(7);try{let e=(0,u.Tx)(t),r=new Date(e.expiresAt),i=new Date;if(r<i)return a.NextResponse.json({valid:!1,error:"License expired",expiresAt:e.expiresAt});return a.NextResponse.json({valid:!0,tier:e.tier,email:e.email,expiresAt:e.expiresAt,repoCount:e.repoCount,features:e.features})}catch(e){return a.NextResponse.json({valid:!1,error:"Invalid license key"})}}catch(e){return console.error("Verify route error:",e),a.NextResponse.json({error:"Verification failed"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/verify/route",pathname:"/api/verify",filename:"route",bundlePath:"app/api/verify/route"},resolvedPagePath:"C:\\Users\\mevla\\OneDrive\\Desktop\\projects\\IntentOS\\packages\\isl-verify-monorepo\\packages\\license-server\\src\\app\\api\\verify\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:v}=c,x="/api/verify/route";function f(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:d})}},1876:(e,r,t)=>{t.d(r,{LB:()=>n,LC:()=>u,Tx:()=>a});var i=t(1769),s=t.n(i);let o=process.env.LICENSE_JWT_SECRET||"default-secret-change-me";function n(e){let r={...e,issuer:"shipgate",issuedAt:new Date().toISOString()};return s().sign(r,o,{algorithm:"HS256"})}function a(e){return s().verify(e,o,{algorithms:["HS256"]})}function u(e){return({free:["tier1"],team:["tier1","tier2","tier3","github-action","compliance","dashboard"],enterprise:["tier1","tier2","tier3","github-action","compliance","dashboard","sso","custom-provers","on-prem","sla","audit-export"]})[e]||[]}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[406,525,769],()=>t(2842));module.exports=i})();