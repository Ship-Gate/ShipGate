{"version":3,"sources":["../src/server.ts","../src/documents.ts","../src/features/completion.ts","../src/features/hover.ts","../src/features/diagnostics.ts","../src/features/import-resolver.ts","../src/features/semantic-linter.ts","../src/features/definition.ts","../src/features/symbols.ts","../src/features/semantic-tokens.ts","../src/features/actions.ts","../src/features/formatting.ts","../src/features/scanner-diagnostics.ts","../src/cli.ts"],"sourcesContent":["// ============================================================================\n// ISL Language Server\n// ============================================================================\n\nimport {\n  createConnection,\n  TextDocuments,\n  ProposedFeatures,\n  InitializeParams,\n  InitializeResult,\n  TextDocumentSyncKind,\n  CompletionItem as VSCompletionItem,\n  CompletionItemKind,\n  Hover,\n  Definition,\n  DocumentSymbol,\n  SymbolKind,\n  SemanticTokensBuilder,\n  Connection,\n  TextDocumentPositionParams,\n  DocumentSymbolParams,\n  SemanticTokensParams,\n  TextDocumentChangeEvent,\n  CodeActionParams,\n  CodeAction,\n  CodeActionKind,\n  DocumentFormattingParams,\n  TextEdit,\n  Diagnostic,\n} from 'vscode-languageserver/node.js';\n\nimport { TextDocument } from 'vscode-languageserver-textdocument';\nimport { ISLDocumentManager } from './documents';\nimport { ISLCompletionProvider } from './features/completion';\nimport { ISLHoverProvider } from './features/hover';\nimport { ISLDiagnosticsProvider } from './features/diagnostics';\nimport { ISLDefinitionProvider } from './features/definition';\nimport { ISLSymbolProvider } from './features/symbols';\nimport { ISLSemanticTokensProvider, TOKEN_TYPES, TOKEN_MODIFIERS } from './features/semantic-tokens';\nimport { ISLCodeActionProvider } from './features/actions';\nimport { ISLFormattingProvider } from './features/formatting';\nimport { ScannerDiagnosticsProvider, SOURCE_HOST, SOURCE_REALITY_GAP } from './features/scanner-diagnostics';\nimport { DiagnosticSeverity } from '@isl-lang/lsp-core';\n\nexport class ISLServer {\n  private connection: Connection;\n  private documents: TextDocuments<TextDocument>;\n  private documentManager: ISLDocumentManager;\n  private completionProvider: ISLCompletionProvider;\n  private hoverProvider: ISLHoverProvider;\n  private diagnosticsProvider: ISLDiagnosticsProvider;\n  private definitionProvider: ISLDefinitionProvider;\n  private symbolProvider: ISLSymbolProvider;\n  private semanticTokensProvider: ISLSemanticTokensProvider;\n  private codeActionProvider: ISLCodeActionProvider;\n  private formattingProvider: ISLFormattingProvider;\n  private scannerDiagnosticsProvider: ScannerDiagnosticsProvider;\n  private diagnosticTimers = new Map<string, NodeJS.Timeout>();\n  private lastScannerDiagnostics = new Map<string, Diagnostic[]>();\n  private scannerVersions = new Map<string, number>();\n\n  constructor() {\n    this.connection = createConnection(ProposedFeatures.all);\n    this.documents = new TextDocuments(TextDocument);\n    this.documentManager = new ISLDocumentManager();\n    this.completionProvider = new ISLCompletionProvider(this.documentManager);\n    this.hoverProvider = new ISLHoverProvider(this.documentManager);\n    this.diagnosticsProvider = new ISLDiagnosticsProvider(this.documentManager);\n    this.definitionProvider = new ISLDefinitionProvider(this.documentManager);\n    this.symbolProvider = new ISLSymbolProvider(this.documentManager);\n    this.semanticTokensProvider = new ISLSemanticTokensProvider(this.documentManager);\n    this.codeActionProvider = new ISLCodeActionProvider(this.documentManager);\n    this.formattingProvider = new ISLFormattingProvider();\n    this.scannerDiagnosticsProvider = new ScannerDiagnosticsProvider();\n\n    this.setupHandlers();\n  }\n\n  private setupHandlers(): void {\n    // Initialize\n    this.connection.onInitialize((params: InitializeParams): InitializeResult => {\n      return {\n        capabilities: {\n          textDocumentSync: TextDocumentSyncKind.Incremental,\n          completionProvider: {\n            triggerCharacters: ['.', ':', '@', '{', '<'],\n            resolveProvider: true,\n          },\n          hoverProvider: true,\n          definitionProvider: true,\n          documentSymbolProvider: true,\n          documentFormattingProvider: true,\n          codeActionProvider: {\n            codeActionKinds: [\n              CodeActionKind.QuickFix,\n              CodeActionKind.Refactor,\n              CodeActionKind.Source,\n            ],\n          },\n          semanticTokensProvider: {\n            legend: {\n              tokenTypes: TOKEN_TYPES,\n              tokenModifiers: TOKEN_MODIFIERS,\n            },\n            full: true,\n          },\n          workspace: {\n            workspaceFolders: {\n              supported: true,\n            },\n          },\n        },\n      };\n    });\n\n    // Document open - parse immediately\n    this.documents.onDidOpen((event) => {\n      this.documentManager.updateDocument(event.document, true);\n      this.validateDocument(event.document);\n    });\n\n    // Document change - debounced parse\n    this.documents.onDidChangeContent((change: TextDocumentChangeEvent<TextDocument>) => {\n      this.documentManager.updateDocument(change.document, false);\n      this.scheduleValidation(change.document);\n    });\n\n    // Document save - parse immediately and validate\n    this.documents.onDidSave((event) => {\n      const doc = this.documents.get(event.document.uri);\n      if (doc) {\n        this.documentManager.updateDocument(doc, true);\n        this.validateDocument(doc);\n      }\n    });\n\n    // Document close\n    this.documents.onDidClose((event) => {\n      this.documentManager.removeDocument(event.document.uri);\n      this.clearDiagnostics(event.document.uri);\n    });\n\n    // Completion\n    this.connection.onCompletion((params: TextDocumentPositionParams): VSCompletionItem[] => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return [];\n\n      const items = this.completionProvider.provideCompletions(document, params.position);\n      return items.map((item, index) => ({\n        label: item.label,\n        kind: this.mapCompletionKind(item.kind),\n        detail: item.detail,\n        documentation: item.documentation,\n        insertText: item.insertText,\n        insertTextFormat: item.insertTextFormat === 'snippet' ? 2 : 1,\n        sortText: item.sortText,\n        filterText: item.filterText,\n        preselect: item.preselect,\n        deprecated: item.deprecated,\n        data: index,\n      }));\n    });\n\n    // Hover\n    this.connection.onHover((params: TextDocumentPositionParams): Hover | null => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return null;\n\n      // Check for scanner diagnostic hover first\n      const scannerHover = this.getScannerHover(params.textDocument.uri, params.position);\n      if (scannerHover) return scannerHover;\n\n      const hover = this.hoverProvider.provideHover(document, params.position);\n      if (!hover) return null;\n\n      return {\n        contents: {\n          kind: 'markdown',\n          value: hover.contents,\n        },\n        range: hover.range,\n      };\n    });\n\n    // Go to definition\n    this.connection.onDefinition((params: TextDocumentPositionParams): Definition | null => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return null;\n\n      return this.definitionProvider.provideDefinition(document, params.position);\n    });\n\n    // Document symbols\n    this.connection.onDocumentSymbol((params: DocumentSymbolParams): DocumentSymbol[] => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return [];\n\n      const symbols = this.symbolProvider.provideSymbols(document);\n      return symbols.map((sym) => this.mapSymbol(sym));\n    });\n\n    // Code actions\n    this.connection.onCodeAction((params: CodeActionParams): CodeAction[] => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return [];\n\n      const actions = this.codeActionProvider.provideCodeActions(document, params.range, params.context);\n\n      // Append scanner-specific code actions\n      for (const diag of params.context.diagnostics) {\n        if (diag.source !== SOURCE_HOST && diag.source !== SOURCE_REALITY_GAP) continue;\n\n        const data = diag.data as { suggestion?: string; tier?: string; quickFixes?: Array<{ title: string; edit: string }> } | undefined;\n\n        // Suppress-line action: insert a comment above the offending line\n        const suppressComment = diag.source === SOURCE_HOST\n          ? `// shipgate-ignore`\n          : `// islstudio-ignore ${diag.code}`;\n\n        actions.push({\n          title: `Suppress ${diag.code} for this line`,\n          kind: CodeActionKind.QuickFix,\n          diagnostics: [diag],\n          edit: {\n            changes: {\n              [document.uri]: [\n                TextEdit.insert(\n                  { line: diag.range.start.line, character: 0 },\n                  suppressComment + '\\n'\n                ),\n              ],\n            },\n          },\n        });\n\n        // Surface quickFixes from scanner data if present\n        if (data?.quickFixes) {\n          for (const fix of data.quickFixes) {\n            actions.push({\n              title: fix.title,\n              kind: CodeActionKind.QuickFix,\n              diagnostics: [diag],\n              edit: {\n                changes: {\n                  [document.uri]: [\n                    TextEdit.replace(diag.range, fix.edit),\n                  ],\n                },\n              },\n            });\n          }\n        }\n      }\n\n      return actions;\n    });\n\n    // Document formatting\n    this.connection.onDocumentFormatting((params: DocumentFormattingParams): TextEdit[] => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return [];\n\n      return this.formattingProvider.format(document, params.options);\n    });\n\n    // Semantic tokens\n    this.connection.languages.semanticTokens.on((params: SemanticTokensParams) => {\n      const document = this.documents.get(params.textDocument.uri);\n      if (!document) return { data: [] };\n\n      const tokens = this.semanticTokensProvider.provideTokens(document);\n      const builder = new SemanticTokensBuilder();\n\n      for (const token of tokens) {\n        builder.push(\n          token.line,\n          token.startChar,\n          token.length,\n          TOKEN_TYPES.indexOf(token.tokenType),\n          this.encodeModifiers(token.tokenModifiers)\n        );\n      }\n\n      return builder.build();\n    });\n\n    // Custom requests\n    this.connection.onRequest('isl/validate', (params: { uri: string }) => {\n      const document = this.documents.get(params.uri);\n      if (!document) {\n        return { valid: false, errors: ['Document not found'] };\n      }\n\n      // Force immediate parse\n      this.documentManager.updateDocument(document, true);\n      const diagnostics = this.documentManager.getDiagnostics(params.uri);\n      const errors = diagnostics\n        .filter(d => d.severity === DiagnosticSeverity.Error)\n        .map(d => d.message);\n\n      return { valid: errors.length === 0, errors };\n    });\n\n    // Listen\n    this.documents.listen(this.connection);\n  }\n\n  private scheduleValidation(document: TextDocument): void {\n    const uri = document.uri;\n\n    // Clear existing timer\n    const existing = this.diagnosticTimers.get(uri);\n    if (existing) {\n      clearTimeout(existing);\n    }\n\n    // Schedule new validation after debounce\n    const timer = setTimeout(() => {\n      this.diagnosticTimers.delete(uri);\n      const doc = this.documents.get(uri);\n      if (doc) {\n        this.validateDocument(doc);\n      }\n    }, 150); // 150ms debounce\n\n    this.diagnosticTimers.set(uri, timer);\n  }\n\n  private validateDocument(document: TextDocument): void {\n    // Ensure document is parsed\n    this.documentManager.updateDocument(document, true);\n\n    // Get diagnostics from document manager (parser + semantic)\n    const islDiagnostics = this.documentManager.getDiagnostics(document.uri);\n\n    const parserDiagnostics = islDiagnostics.map((d) => ({\n      range: ISLDocumentManager.toRange(d.location),\n      message: d.message,\n      severity: d.severity as 1 | 2 | 3 | 4,\n      code: d.code,\n      source: d.source,\n      relatedInformation: d.relatedInfo?.map(r => ({\n        location: {\n          uri: document.uri,\n          range: ISLDocumentManager.toRange(r.location),\n        },\n        message: r.message,\n      })),\n    }));\n\n    // Send parser diagnostics immediately for fast feedback\n    this.connection.sendDiagnostics({\n      uri: document.uri,\n      diagnostics: parserDiagnostics,\n    });\n\n    // Run scanner diagnostics asynchronously, then merge and re-send\n    this.runScannerDiagnostics(document, parserDiagnostics);\n  }\n\n  /**\n   * Run Host + Reality-Gap scanners async and merge with parser diagnostics.\n   * Suppressions and safelists are applied inside the firewall.\n   */\n  private async runScannerDiagnostics(\n    document: TextDocument,\n    parserDiagnostics: Diagnostic[]\n  ): Promise<void> {\n    try {\n      if (!this.scannerDiagnosticsProvider.isSupported(document)) {\n        // Clear any stale scanner diagnostics for non-supported files\n        this.lastScannerDiagnostics.delete(document.uri);\n        return;\n      }\n\n      // Capture version before async work to detect stale results\n      const versionAtStart = document.version;\n      this.scannerVersions.set(document.uri, versionAtStart);\n\n      const scannerDiags = await this.scannerDiagnosticsProvider.provideDiagnostics(document);\n\n      // Discard results if a newer validation has started since\n      if ((this.scannerVersions.get(document.uri) ?? 0) > versionAtStart) {\n        return;\n      }\n\n      this.lastScannerDiagnostics.set(document.uri, scannerDiags);\n\n      // Merge parser + scanner, deduplicate by code:line:char\n      const merged = this.deduplicateDiagnostics([...parserDiagnostics, ...scannerDiags]);\n\n      // Re-send with merged results\n      this.connection.sendDiagnostics({\n        uri: document.uri,\n        diagnostics: merged,\n      });\n    } catch (err) {\n      // Scanner failure should not break the LSP â€” log and continue\n      console.error('[scanner-diagnostics] Error:', err);\n    }\n  }\n\n  /**\n   * Deduplicate diagnostics by code + start position.\n   * Prefers entries with richer data (e.g. scanner entries with suggestions).\n   */\n  private deduplicateDiagnostics(diagnostics: Diagnostic[]): Diagnostic[] {\n    const byKey = new Map<string, Diagnostic>();\n    for (const d of diagnostics) {\n      const key = `${d.code}:${d.range.start.line}:${d.range.start.character}`;\n      const existing = byKey.get(key);\n      if (!existing) {\n        byKey.set(key, d);\n      } else if (d.data && !existing.data) {\n        byKey.set(key, d);\n      }\n    }\n    return Array.from(byKey.values());\n  }\n\n  private clearDiagnostics(uri: string): void {\n    this.lastScannerDiagnostics.delete(uri);\n    this.scannerVersions.delete(uri);\n    this.connection.sendDiagnostics({ uri, diagnostics: [] });\n  }\n\n  /**\n   * Return hover info for scanner diagnostics at the given position.\n   * Shows tier, source, and suggestion if available.\n   */\n  private getScannerHover(uri: string, position: { line: number; character: number }): Hover | null {\n    const scannerDiags = this.lastScannerDiagnostics.get(uri);\n    if (!scannerDiags || scannerDiags.length === 0) return null;\n\n    // Find scanner diagnostics whose range contains the position\n    const matching = scannerDiags.filter(d => {\n      const r = d.range;\n      if (position.line < r.start.line || position.line > r.end.line) return false;\n      if (position.line === r.start.line && position.character < r.start.character) return false;\n      if (position.line === r.end.line && position.character > r.end.character) return false;\n      return true;\n    });\n\n    if (matching.length === 0) return null;\n\n    const parts: string[] = [];\n    for (const d of matching) {\n      const data = d.data as { suggestion?: string; tier?: string; quickFixes?: unknown[] } | undefined;\n      const tierLabel = data?.tier === 'hard_block' ? 'ðŸ”´ Hard Block'\n        : data?.tier === 'soft_block' ? 'ðŸŸ¡ Soft Block'\n        : 'ðŸ”µ Warning';\n      const sourceLabel = d.source === SOURCE_HOST ? 'Host Scanner' : 'Reality-Gap Scanner';\n\n      let md = `**${sourceLabel}** â€” ${tierLabel}\\n\\n`;\n      md += `**\\`${d.code}\\`**: ${d.message}\\n`;\n      if (data?.suggestion) {\n        md += `\\nðŸ’¡ **Suggestion:** ${data.suggestion}\\n`;\n      }\n      parts.push(md);\n    }\n\n    return {\n      contents: {\n        kind: 'markdown',\n        value: parts.join('\\n---\\n'),\n      },\n      range: matching[0]!.range,\n    };\n  }\n\n  private mapCompletionKind(kind: string): CompletionItemKind {\n    switch (kind) {\n      case 'keyword': return CompletionItemKind.Keyword;\n      case 'type': return CompletionItemKind.TypeParameter;\n      case 'entity': return CompletionItemKind.Class;\n      case 'behavior': return CompletionItemKind.Function;\n      case 'field': return CompletionItemKind.Field;\n      case 'snippet': return CompletionItemKind.Snippet;\n      case 'function': return CompletionItemKind.Function;\n      case 'variable': return CompletionItemKind.Variable;\n      case 'enum': return CompletionItemKind.Enum;\n      case 'property': return CompletionItemKind.Property;\n      default: return CompletionItemKind.Text;\n    }\n  }\n\n  private mapSymbol(sym: { name: string; kind: string; range: { start: { line: number; character: number }; end: { line: number; character: number } }; selectionRange: { start: { line: number; character: number }; end: { line: number; character: number } }; detail?: string; children?: unknown[] }): DocumentSymbol {\n    return {\n      name: sym.name,\n      kind: this.mapSymbolKind(sym.kind),\n      range: sym.range,\n      selectionRange: sym.selectionRange,\n      detail: sym.detail,\n      children: sym.children?.map((c) => this.mapSymbol(c as typeof sym)),\n    };\n  }\n\n  private mapSymbolKind(kind: string): SymbolKind {\n    switch (kind) {\n      case 'domain': return SymbolKind.Namespace;\n      case 'entity': return SymbolKind.Class;\n      case 'behavior': return SymbolKind.Function;\n      case 'type': return SymbolKind.TypeParameter;\n      case 'enum': return SymbolKind.Enum;\n      case 'invariant': return SymbolKind.Interface;\n      case 'policy': return SymbolKind.Interface;\n      case 'view': return SymbolKind.Struct;\n      case 'field': return SymbolKind.Field;\n      case 'input': return SymbolKind.Variable;\n      case 'output': return SymbolKind.Variable;\n      case 'error': return SymbolKind.EnumMember;\n      case 'lifecycle-state': return SymbolKind.EnumMember;\n      case 'scenario': return SymbolKind.Event;\n      case 'chaos': return SymbolKind.Event;\n      case 'variant': return SymbolKind.EnumMember;\n      default: return SymbolKind.Variable;\n    }\n  }\n\n  private encodeModifiers(modifiers: string[]): number {\n    let result = 0;\n    for (const mod of modifiers) {\n      const index = TOKEN_MODIFIERS.indexOf(mod as typeof TOKEN_MODIFIERS[number]);\n      if (index >= 0) {\n        result |= (1 << index);\n      }\n    }\n    return result;\n  }\n\n  start(): void {\n    this.connection.listen();\n  }\n}\n","// ============================================================================\r\n// ISL Document Manager\r\n// Manages document state and integrates with the ISL analyzer\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Range, Position } from 'vscode-languageserver';\r\nimport {\r\n  IncrementalParser,\r\n  SymbolIndex,\r\n  type AnalysisResult,\r\n  type ISLSymbolInfo,\r\n  type ISLDiagnostic,\r\n  type IndexedSymbol,\r\n  type CompletionContext,\r\n  type ContextType,\r\n  type SourceLocation,\r\n  type Domain,\r\n} from '@isl-lang/lsp-core';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\nexport interface ParsedDocument {\r\n  uri: string;\r\n  version: number;\r\n  analysisResult: AnalysisResult;\r\n  domain?: Domain;\r\n}\r\n\r\n// ============================================================================\r\n// Document Manager\r\n// ============================================================================\r\n\r\nexport class ISLDocumentManager {\r\n  private parser: IncrementalParser;\r\n  private symbolIndex: SymbolIndex;\r\n  private documents = new Map<string, ParsedDocument>();\r\n  private pendingUpdates = new Map<string, NodeJS.Timeout>();\r\n  private debounceMs = 150;\r\n\r\n  constructor() {\r\n    this.parser = new IncrementalParser();\r\n    this.symbolIndex = new SymbolIndex();\r\n  }\r\n\r\n  /**\r\n   * Update a document with debouncing\r\n   */\r\n  updateDocument(document: TextDocument, immediate = false): ParsedDocument | undefined {\r\n    const uri = document.uri;\r\n\r\n    // Clear any pending update\r\n    const pending = this.pendingUpdates.get(uri);\r\n    if (pending) {\r\n      clearTimeout(pending);\r\n      this.pendingUpdates.delete(uri);\r\n    }\r\n\r\n    if (immediate) {\r\n      return this.parseDocument(document);\r\n    }\r\n\r\n    // Schedule debounced update\r\n    const timeout = setTimeout(() => {\r\n      this.pendingUpdates.delete(uri);\r\n      this.parseDocument(document);\r\n    }, this.debounceMs);\r\n\r\n    this.pendingUpdates.set(uri, timeout);\r\n    return this.documents.get(uri);\r\n  }\r\n\r\n  /**\r\n   * Parse document immediately\r\n   */\r\n  private parseDocument(document: TextDocument): ParsedDocument {\r\n    const uri = document.uri;\r\n    const source = document.getText();\r\n\r\n    // Parse and analyze\r\n    const { result } = this.parser.parse(uri, source, document.version, {\r\n      typeCheck: true,\r\n    });\r\n\r\n    // Update symbol index\r\n    this.symbolIndex.indexSymbols(uri, result.symbols);\r\n\r\n    // Create parsed document\r\n    const parsed: ParsedDocument = {\r\n      uri,\r\n      version: document.version,\r\n      analysisResult: result,\r\n      domain: result.domain,\r\n    };\r\n\r\n    this.documents.set(uri, parsed);\r\n    return parsed;\r\n  }\r\n\r\n  /**\r\n   * Get cached document\r\n   */\r\n  getDocument(uri: string): ParsedDocument | undefined {\r\n    return this.documents.get(uri);\r\n  }\r\n\r\n  /**\r\n   * Remove document from cache\r\n   */\r\n  removeDocument(uri: string): void {\r\n    // Clear pending update\r\n    const pending = this.pendingUpdates.get(uri);\r\n    if (pending) {\r\n      clearTimeout(pending);\r\n      this.pendingUpdates.delete(uri);\r\n    }\r\n\r\n    // Remove from caches\r\n    this.documents.delete(uri);\r\n    this.parser.invalidate(uri);\r\n    this.symbolIndex.clearDocument(uri);\r\n  }\r\n\r\n  /**\r\n   * Get diagnostics for a document\r\n   */\r\n  getDiagnostics(uri: string): ISLDiagnostic[] {\r\n    const doc = this.documents.get(uri);\r\n    return doc?.analysisResult.diagnostics || [];\r\n  }\r\n\r\n  /**\r\n   * Get symbols for a document (for outline view)\r\n   */\r\n  getSymbols(uri: string): ISLSymbolInfo[] {\r\n    const doc = this.documents.get(uri);\r\n    return doc?.analysisResult.symbols || [];\r\n  }\r\n\r\n  // ============================================================================\r\n  // Symbol Lookup\r\n  // ============================================================================\r\n\r\n  /**\r\n   * Find symbol by name\r\n   */\r\n  findSymbol(name: string, kind?: string): IndexedSymbol | undefined {\r\n    return this.symbolIndex.findDefinition(name, kind as IndexedSymbol['kind']);\r\n  }\r\n\r\n  /**\r\n   * Find symbol at position\r\n   */\r\n  getSymbolAtPosition(uri: string, position: Position): IndexedSymbol | undefined {\r\n    // First check the symbol index\r\n    const indexedSym = this.symbolIndex.findAtPosition(uri, position.line + 1, position.character + 1);\r\n    if (indexedSym) return indexedSym;\r\n\r\n    // Fallback: find by word at position\r\n    const doc = this.documents.get(uri);\r\n    if (!doc) return undefined;\r\n\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Get all symbols across all documents\r\n   */\r\n  getAllSymbols(): IndexedSymbol[] {\r\n    return this.symbolIndex.find({});\r\n  }\r\n\r\n  /**\r\n   * Get entity names\r\n   */\r\n  getEntityNames(): string[] {\r\n    return this.symbolIndex.getEntityNames();\r\n  }\r\n\r\n  /**\r\n   * Get behavior names\r\n   */\r\n  getBehaviorNames(): string[] {\r\n    return this.symbolIndex.getBehaviorNames();\r\n  }\r\n\r\n  /**\r\n   * Get type names\r\n   */\r\n  getTypeNames(): string[] {\r\n    return this.symbolIndex.getTypeNames();\r\n  }\r\n\r\n  /**\r\n   * Get fields for a parent symbol\r\n   */\r\n  getFields(parentName: string): IndexedSymbol[] {\r\n    return this.symbolIndex.getFields(parentName);\r\n  }\r\n\r\n  // ============================================================================\r\n  // Context Analysis\r\n  // ============================================================================\r\n\r\n  /**\r\n   * Get completion context at position\r\n   */\r\n  getCompletionContext(document: TextDocument, position: Position): CompletionContext {\r\n    const text = document.getText();\r\n    const lines = text.split('\\n');\r\n    const line = lines[position.line] || '';\r\n    const linePrefix = line.substring(0, position.character);\r\n\r\n    // Find word prefix\r\n    const prefixMatch = linePrefix.match(/[\\w@.]*$/);\r\n    const prefix = prefixMatch ? prefixMatch[0] : '';\r\n\r\n    // Find trigger character\r\n    const triggerChar = prefix.length > 0 ? undefined : \r\n      linePrefix.length > 0 ? linePrefix[linePrefix.length - 1] : undefined;\r\n\r\n    // Determine context type\r\n    const contextType = this.determineContextType(lines, position);\r\n\r\n    return {\r\n      contextType,\r\n      triggerCharacter: triggerChar,\r\n      prefix,\r\n      line,\r\n      position: { line: position.line, character: position.character },\r\n      parentSymbol: this.findParentSymbol(lines, position),\r\n      inPostcondition: this.isInPostcondition(lines, position.line),\r\n    };\r\n  }\r\n\r\n  private determineContextType(lines: string[], position: Position): ContextType {\r\n    let braceDepth = 0;\r\n    let currentBlock = '';\r\n    let currentSection = '';\r\n\r\n    for (let i = 0; i <= position.line; i++) {\r\n      const line = lines[i] || '';\r\n      const trimmed = line.trim();\r\n\r\n      // Track brace depth\r\n      braceDepth += (line.match(/\\{/g) || []).length;\r\n      braceDepth -= (line.match(/\\}/g) || []).length;\r\n\r\n      // Track current block\r\n      if (trimmed.match(/^domain\\s+\\w+/)) {\r\n        currentBlock = 'domain';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^entity\\s+\\w+/)) {\r\n        currentBlock = 'entity';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^behavior\\s+\\w+/)) {\r\n        currentBlock = 'behavior';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^invariant\\s+\\w+/)) {\r\n        currentBlock = 'invariant';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^policy\\s+\\w+/)) {\r\n        currentBlock = 'policy';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^view\\s+\\w+/)) {\r\n        currentBlock = 'view';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^scenarios?\\s+\\w+/)) {\r\n        currentBlock = 'scenario';\r\n        currentSection = '';\r\n      } else if (trimmed.match(/^chaos\\s+\\w+/)) {\r\n        currentBlock = 'chaos';\r\n        currentSection = '';\r\n      }\r\n\r\n      // Track sections within blocks\r\n      if (trimmed === 'input {') currentSection = 'input';\r\n      else if (trimmed === 'output {') currentSection = 'output';\r\n      else if (trimmed.startsWith('preconditions {') || trimmed === 'pre {') currentSection = 'pre';\r\n      else if (trimmed.startsWith('postconditions {') || trimmed === 'post {') currentSection = 'post';\r\n      else if (trimmed === 'invariants {') currentSection = 'invariant';\r\n      else if (trimmed === 'temporal {') currentSection = 'temporal';\r\n      else if (trimmed === 'security {') currentSection = 'security';\r\n      else if (trimmed === 'lifecycle {') currentSection = 'lifecycle';\r\n    }\r\n\r\n    // Check current line for type annotation context\r\n    const currentLine = lines[position.line] || '';\r\n    const beforeCursor = currentLine.substring(0, position.character);\r\n    if (beforeCursor.match(/:\\s*$/)) {\r\n      return 'type-annotation';\r\n    }\r\n\r\n    // Return context based on tracking\r\n    if (braceDepth === 0) return 'top-level';\r\n    if (braceDepth === 1 && !currentBlock) return 'domain';\r\n\r\n    switch (currentBlock) {\r\n      case 'entity':\r\n        if (currentSection === 'invariant') return 'expression';\r\n        if (currentSection === 'lifecycle') return 'entity-field';\r\n        return 'entity-field';\r\n      case 'behavior':\r\n        switch (currentSection) {\r\n          case 'input': return 'behavior-input';\r\n          case 'output': return 'behavior-output';\r\n          case 'pre': return 'behavior-pre';\r\n          case 'post': return 'behavior-post';\r\n          case 'invariant': return 'behavior-invariant';\r\n          case 'temporal': return 'behavior-temporal';\r\n          case 'security': return 'behavior-security';\r\n          default: return 'behavior';\r\n        }\r\n      case 'invariant':\r\n        return 'invariant';\r\n      case 'policy':\r\n        return 'policy';\r\n      case 'view':\r\n        return 'view';\r\n      case 'scenario':\r\n        return 'scenario';\r\n      case 'chaos':\r\n        return 'chaos';\r\n      default:\r\n        return 'domain';\r\n    }\r\n  }\r\n\r\n  private findParentSymbol(lines: string[], position: Position): string | undefined {\r\n    for (let i = position.line; i >= 0; i--) {\r\n      const line = lines[i] || '';\r\n      const trimmed = line.trim();\r\n\r\n      const entityMatch = trimmed.match(/^entity\\s+(\\w+)/);\r\n      if (entityMatch) return entityMatch[1];\r\n\r\n      const behaviorMatch = trimmed.match(/^behavior\\s+(\\w+)/);\r\n      if (behaviorMatch) return behaviorMatch[1];\r\n\r\n      const domainMatch = trimmed.match(/^domain\\s+(\\w+)/);\r\n      if (domainMatch) return domainMatch[1];\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  private isInPostcondition(lines: string[], lineNum: number): boolean {\r\n    let braceDepth = 0;\r\n\r\n    for (let i = lineNum; i >= 0; i--) {\r\n      const line = lines[i]?.trim() || '';\r\n      braceDepth += (line.match(/\\}/g) || []).length;\r\n      braceDepth -= (line.match(/\\{/g) || []).length;\r\n\r\n      if ((line.startsWith('postconditions {') || line === 'post {') && braceDepth <= 0) {\r\n        return true;\r\n      }\r\n      if ((line.startsWith('preconditions {') || line === 'pre {') && braceDepth <= 0) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // ============================================================================\r\n  // Word at Position\r\n  // ============================================================================\r\n\r\n  /**\r\n   * Get word at cursor position\r\n   */\r\n  getWordAtPosition(document: TextDocument, position: Position): string {\r\n    const text = document.getText();\r\n    const lines = text.split('\\n');\r\n    const line = lines[position.line];\r\n    if (!line) return '';\r\n\r\n    // Find word boundaries\r\n    let start = position.character;\r\n    let end = position.character;\r\n\r\n    while (start > 0 && /[\\w]/.test(line[start - 1] || '')) {\r\n      start--;\r\n    }\r\n    while (end < line.length && /[\\w]/.test(line[end] || '')) {\r\n      end++;\r\n    }\r\n\r\n    return line.substring(start, end);\r\n  }\r\n\r\n  /**\r\n   * Get word range at position\r\n   */\r\n  getWordRangeAtPosition(document: TextDocument, position: Position): Range | undefined {\r\n    const text = document.getText();\r\n    const lines = text.split('\\n');\r\n    const line = lines[position.line];\r\n    if (!line) return undefined;\r\n\r\n    let start = position.character;\r\n    let end = position.character;\r\n\r\n    while (start > 0 && /[\\w]/.test(line[start - 1] || '')) {\r\n      start--;\r\n    }\r\n    while (end < line.length && /[\\w]/.test(line[end] || '')) {\r\n      end++;\r\n    }\r\n\r\n    if (start === end) return undefined;\r\n\r\n    return {\r\n      start: { line: position.line, character: start },\r\n      end: { line: position.line, character: end },\r\n    };\r\n  }\r\n\r\n  // ============================================================================\r\n  // Utilities\r\n  // ============================================================================\r\n\r\n  /**\r\n   * Convert ISL SourceLocation to LSP Range\r\n   */\r\n  static toRange(loc: SourceLocation): Range {\r\n    return {\r\n      start: { line: loc.line - 1, character: loc.column - 1 },\r\n      end: { line: loc.endLine - 1, character: loc.endColumn - 1 },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Convert LSP Position to ISL line/column (1-based)\r\n   */\r\n  static toISLPosition(position: Position): { line: number; column: number } {\r\n    return {\r\n      line: position.line + 1,\r\n      column: position.character + 1,\r\n    };\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Completion Provider\r\n// Context-aware completion suggestions\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Position } from 'vscode-languageserver';\r\nimport type { ISLDocumentManager } from '../documents';\r\nimport type { ISLCompletionInfo, ContextType } from '@isl-lang/lsp-core';\r\n\r\n// ============================================================================\r\n// ISL Keywords by Context\r\n// ============================================================================\r\n\r\nconst TOP_LEVEL_KEYWORDS = [\r\n  { label: 'domain', doc: 'Define a new domain' },\r\n];\r\n\r\nconst DOMAIN_KEYWORDS = [\r\n  { label: 'entity', doc: 'Define a persistent entity' },\r\n  { label: 'behavior', doc: 'Define a behavior/operation' },\r\n  { label: 'type', doc: 'Define a custom type' },\r\n  { label: 'enum', doc: 'Define an enumeration' },\r\n  { label: 'invariants', doc: 'Define global invariants' },\r\n  { label: 'policy', doc: 'Define a policy' },\r\n  { label: 'view', doc: 'Define a view/projection' },\r\n  { label: 'scenarios', doc: 'Define test scenarios' },\r\n  { label: 'chaos', doc: 'Define chaos tests' },\r\n  { label: 'version', doc: 'Domain version' },\r\n  { label: 'owner', doc: 'Domain owner' },\r\n  { label: 'imports', doc: 'Import from other domains' },\r\n];\r\n\r\nconst ENTITY_KEYWORDS = [\r\n  { label: 'invariants', doc: 'Entity invariants' },\r\n  { label: 'lifecycle', doc: 'Entity lifecycle states' },\r\n];\r\n\r\nconst BEHAVIOR_KEYWORDS = [\r\n  { label: 'description', doc: 'Behavior description' },\r\n  { label: 'actors', doc: 'Authorized actors' },\r\n  { label: 'input', doc: 'Input parameters' },\r\n  { label: 'output', doc: 'Output specification' },\r\n  { label: 'preconditions', doc: 'Preconditions' },\r\n  { label: 'postconditions', doc: 'Postconditions' },\r\n  { label: 'invariants', doc: 'Behavior invariants' },\r\n  { label: 'temporal', doc: 'Temporal constraints' },\r\n  { label: 'security', doc: 'Security requirements' },\r\n  { label: 'compliance', doc: 'Compliance requirements' },\r\n  { label: 'observability', doc: 'Observability settings' },\r\n];\r\n\r\nconst OUTPUT_KEYWORDS = [\r\n  { label: 'success', doc: 'Success return type' },\r\n  { label: 'errors', doc: 'Error cases' },\r\n];\r\n\r\nconst ERROR_KEYWORDS = [\r\n  { label: 'when', doc: 'Error condition description' },\r\n  { label: 'retriable', doc: 'Whether error is retriable' },\r\n  { label: 'retry_after', doc: 'Retry delay' },\r\n  { label: 'returns', doc: 'Error return type' },\r\n];\r\n\r\nconst TEMPORAL_KEYWORDS = [\r\n  { label: 'response', doc: 'Response time constraint' },\r\n  { label: 'eventually', doc: 'Eventually happens' },\r\n  { label: 'always', doc: 'Always true' },\r\n  { label: 'never', doc: 'Never happens' },\r\n  { label: 'within', doc: 'Within time constraint' },\r\n  { label: 'immediately', doc: 'Immediate effect' },\r\n];\r\n\r\nconst SECURITY_KEYWORDS = [\r\n  { label: 'requires', doc: 'Required permission/capability' },\r\n  { label: 'rate_limit', doc: 'Rate limiting' },\r\n  { label: 'brute_force_protection', doc: 'Brute force protection' },\r\n];\r\n\r\nconst EXPRESSION_KEYWORDS = [\r\n  { label: 'forall', doc: 'Universal quantifier' },\r\n  { label: 'exists', doc: 'Existential quantifier' },\r\n  { label: 'implies', doc: 'Logical implication' },\r\n  { label: 'and', doc: 'Logical and' },\r\n  { label: 'or', doc: 'Logical or' },\r\n  { label: 'not', doc: 'Logical negation' },\r\n  { label: 'true', doc: 'Boolean true' },\r\n  { label: 'false', doc: 'Boolean false' },\r\n  { label: 'null', doc: 'Null value' },\r\n];\r\n\r\nconst POSTCONDITION_KEYWORDS = [\r\n  { label: 'old', doc: 'Reference to pre-state value' },\r\n  { label: 'result', doc: 'Reference to operation result' },\r\n  { label: 'success', doc: 'Success postcondition block' },\r\n  { label: 'failure', doc: 'Failure postcondition block' },\r\n  ...EXPRESSION_KEYWORDS,\r\n];\r\n\r\nconst SCENARIO_KEYWORDS = [\r\n  { label: 'scenario', doc: 'Define a test scenario' },\r\n  { label: 'given', doc: 'Setup state' },\r\n  { label: 'when', doc: 'Action to test' },\r\n  { label: 'then', doc: 'Expected outcome' },\r\n];\r\n\r\n// ============================================================================\r\n// Built-in Types\r\n// ============================================================================\r\n\r\nconst BUILTIN_TYPES: ISLCompletionInfo[] = [\r\n  { label: 'String', kind: 'type', detail: 'UTF-8 text value', documentation: 'A sequence of Unicode characters' },\r\n  { label: 'Int', kind: 'type', detail: 'Integer value', documentation: '64-bit signed integer' },\r\n  { label: 'Decimal', kind: 'type', detail: 'Decimal number', documentation: 'Arbitrary precision decimal' },\r\n  { label: 'Boolean', kind: 'type', detail: 'Boolean value', documentation: 'true or false' },\r\n  { label: 'UUID', kind: 'type', detail: 'Universally unique identifier', documentation: '128-bit identifier' },\r\n  { label: 'Timestamp', kind: 'type', detail: 'Date and time with timezone', documentation: 'Instant in time' },\r\n  { label: 'Duration', kind: 'type', detail: 'Time duration', documentation: 'Length of time (ms, seconds, minutes, hours, days)' },\r\n  { label: 'Date', kind: 'type', detail: 'Calendar date', documentation: 'Date without time' },\r\n  { label: 'Time', kind: 'type', detail: 'Time of day', documentation: 'Time without date' },\r\n  { label: 'List', kind: 'type', detail: 'Ordered collection', documentation: 'List<T> - ordered sequence of elements', insertText: 'List<${1:T}>', insertTextFormat: 'snippet' },\r\n  { label: 'Map', kind: 'type', detail: 'Key-value collection', documentation: 'Map<K, V> - key-value pairs', insertText: 'Map<${1:K}, ${2:V}>', insertTextFormat: 'snippet' },\r\n  { label: 'Set', kind: 'type', detail: 'Unique collection', documentation: 'Set<T> - unique elements', insertText: 'Set<${1:T}>', insertTextFormat: 'snippet' },\r\n  { label: 'Optional', kind: 'type', detail: 'Nullable value', documentation: 'Optional<T> - may be null', insertText: 'Optional<${1:T}>', insertTextFormat: 'snippet' },\r\n];\r\n\r\n// ============================================================================\r\n// Built-in Functions\r\n// ============================================================================\r\n\r\nconst BUILTIN_FUNCTIONS: ISLCompletionInfo[] = [\r\n  { label: 'old', kind: 'function', detail: 'Previous value', documentation: 'Reference to value before operation', insertText: 'old(${1:expr})', insertTextFormat: 'snippet' },\r\n  { label: 'len', kind: 'function', detail: 'Length of collection', documentation: 'Returns the number of elements', insertText: 'len(${1:collection})', insertTextFormat: 'snippet' },\r\n  { label: 'sum', kind: 'function', detail: 'Sum of collection', documentation: 'Sum all numeric elements', insertText: 'sum(${1:collection})', insertTextFormat: 'snippet' },\r\n  { label: 'count', kind: 'function', detail: 'Count elements', documentation: 'Count matching elements', insertText: 'count(${1:collection}, ${2:predicate})', insertTextFormat: 'snippet' },\r\n  { label: 'filter', kind: 'function', detail: 'Filter collection', documentation: 'Filter elements by predicate', insertText: 'filter(${1:collection}, ${2:predicate})', insertTextFormat: 'snippet' },\r\n  { label: 'all', kind: 'function', detail: 'All match', documentation: 'Check if all elements match predicate', insertText: 'all(${1:collection}, ${2:item} => ${3:predicate})', insertTextFormat: 'snippet' },\r\n  { label: 'any', kind: 'function', detail: 'Any match', documentation: 'Check if any element matches predicate', insertText: 'any(${1:collection}, ${2:item} => ${3:predicate})', insertTextFormat: 'snippet' },\r\n  { label: 'none', kind: 'function', detail: 'None match', documentation: 'Check if no elements match predicate', insertText: 'none(${1:collection}, ${2:item} => ${3:predicate})', insertTextFormat: 'snippet' },\r\n  { label: 'now', kind: 'function', detail: 'Current timestamp', documentation: 'Returns the current timestamp', insertText: 'now()' },\r\n  { label: 'exists', kind: 'function', detail: 'Entity exists', documentation: 'Check if entity exists', insertText: 'exists(${1:id})', insertTextFormat: 'snippet' },\r\n  { label: 'lookup', kind: 'function', detail: 'Lookup entity', documentation: 'Find entity by ID or field', insertText: 'lookup(${1:id})', insertTextFormat: 'snippet' },\r\n];\r\n\r\n// ============================================================================\r\n// Snippets\r\n// ============================================================================\r\n\r\nconst DOMAIN_SNIPPET: ISLCompletionInfo = {\r\n  label: 'domain',\r\n  kind: 'snippet',\r\n  detail: 'Create a new domain',\r\n  insertText: `domain \\${1:Name} {\r\n  version: \"\\${2:1.0.0}\"\r\n\r\n  $0\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n  preselect: true,\r\n};\r\n\r\nconst ENTITY_SNIPPET: ISLCompletionInfo = {\r\n  label: 'entity',\r\n  kind: 'snippet',\r\n  detail: 'Create a new entity',\r\n  insertText: `entity \\${1:Name} {\r\n  id: UUID [immutable, unique]\r\n  \\${2:field}: \\${3:String}\r\n\r\n  invariants {\r\n    $0\r\n  }\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\nconst BEHAVIOR_SNIPPET: ISLCompletionInfo = {\r\n  label: 'behavior',\r\n  kind: 'snippet',\r\n  detail: 'Create a new behavior',\r\n  insertText: `behavior \\${1:Name} {\r\n  description: \"\\${2:Description}\"\r\n\r\n  input {\r\n    \\${3:param}: \\${4:String}\r\n  }\r\n\r\n  output {\r\n    success: \\${5:Boolean}\r\n\r\n    errors {\r\n      \\${6:ERROR_NAME} {\r\n        when: \"\\${7:Error description}\"\r\n        retriable: \\${8|true,false|}\r\n      }\r\n    }\r\n  }\r\n\r\n  preconditions {\r\n    \\${9:input.param != null}\r\n  }\r\n\r\n  postconditions {\r\n    success implies {\r\n      $0\r\n    }\r\n  }\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\nconst TYPE_SNIPPET: ISLCompletionInfo = {\r\n  label: 'type',\r\n  kind: 'snippet',\r\n  detail: 'Create a custom type',\r\n  insertText: `type \\${1:Name} = \\${2:String} {\r\n  \\${3:constraint}: \\${4:value}\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\nconst ENUM_SNIPPET: ISLCompletionInfo = {\r\n  label: 'enum',\r\n  kind: 'snippet',\r\n  detail: 'Create an enumeration',\r\n  insertText: `enum \\${1:Name} {\r\n  \\${2:VARIANT1}\r\n  \\${3:VARIANT2}\r\n  $0\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\nconst INVARIANT_SNIPPET: ISLCompletionInfo = {\r\n  label: 'invariants',\r\n  kind: 'snippet',\r\n  detail: 'Create an invariant block',\r\n  insertText: `invariants \\${1:Name} {\r\n  description: \"\\${2:Description}\"\r\n  scope: \\${3|global,transaction|}\r\n\r\n  always {\r\n    $0\r\n  }\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\nconst SCENARIO_SNIPPET: ISLCompletionInfo = {\r\n  label: 'scenario',\r\n  kind: 'snippet',\r\n  detail: 'Create a test scenario',\r\n  insertText: `scenario \"\\${1:Test scenario}\" {\r\n  given {\r\n    \\${2:setup}\r\n  }\r\n\r\n  when {\r\n    \\${3:action}\r\n  }\r\n\r\n  then {\r\n    $0\r\n  }\r\n}`,\r\n  insertTextFormat: 'snippet',\r\n};\r\n\r\n// ============================================================================\r\n// Completion Provider\r\n// ============================================================================\r\n\r\nexport class ISLCompletionProvider {\r\n  constructor(private documentManager: ISLDocumentManager) {}\r\n\r\n  provideCompletions(document: TextDocument, position: Position): ISLCompletionInfo[] {\r\n    const context = this.documentManager.getCompletionContext(document, position);\r\n    const items: ISLCompletionInfo[] = [];\r\n\r\n    // Get context-appropriate completions\r\n    switch (context.contextType) {\r\n      case 'top-level':\r\n        items.push(DOMAIN_SNIPPET);\r\n        items.push(...TOP_LEVEL_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'domain':\r\n        items.push(ENTITY_SNIPPET);\r\n        items.push(BEHAVIOR_SNIPPET);\r\n        items.push(TYPE_SNIPPET);\r\n        items.push(ENUM_SNIPPET);\r\n        items.push(INVARIANT_SNIPPET);\r\n        items.push(...DOMAIN_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'entity':\r\n      case 'entity-field':\r\n        items.push(...ENTITY_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'behavior':\r\n        items.push(...BEHAVIOR_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'behavior-input':\r\n      case 'behavior-output':\r\n        // Type completions for field declarations\r\n        break;\r\n\r\n      case 'behavior-pre':\r\n        items.push(...EXPRESSION_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        items.push(...BUILTIN_FUNCTIONS.filter(f => f.label !== 'old' && f.label !== 'result'));\r\n        break;\r\n\r\n      case 'behavior-post':\r\n        items.push(...POSTCONDITION_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        items.push(...BUILTIN_FUNCTIONS);\r\n        break;\r\n\r\n      case 'behavior-temporal':\r\n        items.push(...TEMPORAL_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'behavior-security':\r\n        items.push(...SECURITY_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'scenario':\r\n        items.push(SCENARIO_SNIPPET);\r\n        items.push(...SCENARIO_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        break;\r\n\r\n      case 'type-annotation':\r\n        items.push(...BUILTIN_TYPES);\r\n        items.push(...this.getCustomTypeCompletions());\r\n        items.push(...this.getEntityCompletions());\r\n        break;\r\n\r\n      case 'expression':\r\n      case 'invariant':\r\n      case 'policy':\r\n        items.push(...EXPRESSION_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n        items.push(...BUILTIN_FUNCTIONS);\r\n        break;\r\n\r\n      default:\r\n        // Default: mix of keywords and types\r\n        items.push(...EXPRESSION_KEYWORDS.map(k => ({ \r\n          label: k.label, \r\n          kind: 'keyword' as const, \r\n          detail: k.doc \r\n        })));\r\n    }\r\n\r\n    // Add trigger-specific completions\r\n    if (context.triggerCharacter === ':') {\r\n      items.push(...BUILTIN_TYPES);\r\n      items.push(...this.getCustomTypeCompletions());\r\n      items.push(...this.getEntityCompletions());\r\n    }\r\n\r\n    if (context.triggerCharacter === '.') {\r\n      items.push(...this.getMemberCompletions(context));\r\n    }\r\n\r\n    if (context.triggerCharacter === '@') {\r\n      items.push(...this.getAnnotationCompletions());\r\n    }\r\n\r\n    // Add entity/behavior references if in expression context\r\n    if (['expression', 'behavior-pre', 'behavior-post', 'invariant'].includes(context.contextType)) {\r\n      items.push(...this.getEntityCompletions());\r\n      items.push(...this.getBehaviorCompletions());\r\n    }\r\n\r\n    // Filter by prefix\r\n    if (context.prefix) {\r\n      const prefix = context.prefix.toLowerCase();\r\n      return items.filter(item => \r\n        item.label.toLowerCase().startsWith(prefix) ||\r\n        item.filterText?.toLowerCase().startsWith(prefix)\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  private getCustomTypeCompletions(): ISLCompletionInfo[] {\r\n    const types = this.documentManager.getTypeNames();\r\n    return types.map(name => ({\r\n      label: name,\r\n      kind: 'type' as const,\r\n      detail: 'Custom type',\r\n    }));\r\n  }\r\n\r\n  private getEntityCompletions(): ISLCompletionInfo[] {\r\n    const entities = this.documentManager.getEntityNames();\r\n    return entities.map(name => ({\r\n      label: name,\r\n      kind: 'entity' as const,\r\n      detail: 'Entity',\r\n    }));\r\n  }\r\n\r\n  private getBehaviorCompletions(): ISLCompletionInfo[] {\r\n    const behaviors = this.documentManager.getBehaviorNames();\r\n    return behaviors.map(name => ({\r\n      label: name,\r\n      kind: 'behavior' as const,\r\n      detail: 'Behavior',\r\n    }));\r\n  }\r\n\r\n  private getMemberCompletions(context: { prefix: string; parentSymbol?: string }): ISLCompletionInfo[] {\r\n    const items: ISLCompletionInfo[] = [];\r\n\r\n    // Common entity methods\r\n    items.push(\r\n      { label: 'lookup', kind: 'function', detail: 'Find by ID', insertText: 'lookup(${1:id})', insertTextFormat: 'snippet' },\r\n      { label: 'exists', kind: 'function', detail: 'Check existence', insertText: 'exists(${1:id})', insertTextFormat: 'snippet' },\r\n      { label: 'all', kind: 'function', detail: 'Get all entities' },\r\n      { label: 'count', kind: 'function', detail: 'Count entities' },\r\n      { label: 'filter', kind: 'function', detail: 'Filter entities', insertText: 'filter(${1:predicate})', insertTextFormat: 'snippet' },\r\n    );\r\n\r\n    // Duration units\r\n    items.push(\r\n      { label: 'ms', kind: 'property', detail: 'Milliseconds' },\r\n      { label: 'seconds', kind: 'property', detail: 'Seconds' },\r\n      { label: 'minutes', kind: 'property', detail: 'Minutes' },\r\n      { label: 'hours', kind: 'property', detail: 'Hours' },\r\n      { label: 'days', kind: 'property', detail: 'Days' },\r\n    );\r\n\r\n    // String methods\r\n    items.push(\r\n      { label: 'length', kind: 'property', detail: 'String length' },\r\n      { label: 'is_valid', kind: 'function', detail: 'Validate format' },\r\n      { label: 'is_empty', kind: 'function', detail: 'Check if empty' },\r\n    );\r\n\r\n    // If we know the parent, add its fields\r\n    if (context.parentSymbol) {\r\n      const fields = this.documentManager.getFields(context.parentSymbol);\r\n      for (const field of fields) {\r\n        items.push({\r\n          label: field.name,\r\n          kind: 'field',\r\n          detail: field.detail || field.type,\r\n        });\r\n      }\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  private getAnnotationCompletions(): ISLCompletionInfo[] {\r\n    return [\r\n      { label: 'unique', kind: 'keyword', detail: 'Field must be unique' },\r\n      { label: 'immutable', kind: 'keyword', detail: 'Field cannot be changed' },\r\n      { label: 'indexed', kind: 'keyword', detail: 'Field is indexed' },\r\n      { label: 'sensitive', kind: 'keyword', detail: 'Contains sensitive data' },\r\n      { label: 'secret', kind: 'keyword', detail: 'Contains secret data' },\r\n      { label: 'pii', kind: 'keyword', detail: 'Personally identifiable information' },\r\n      { label: 'computed', kind: 'keyword', detail: 'Derived from other fields' },\r\n      { label: 'deprecated', kind: 'keyword', detail: 'Mark as deprecated' },\r\n      { label: 'default', kind: 'keyword', detail: 'Default value', insertText: 'default: ${1:value}', insertTextFormat: 'snippet' },\r\n    ];\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Hover Provider\r\n// Provides hover information for ISL elements\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Position, Range } from 'vscode-languageserver';\r\nimport type { ISLDocumentManager } from '../documents';\r\n\r\nexport interface HoverResult {\r\n  contents: string;\r\n  range?: Range;\r\n}\r\n\r\n// ============================================================================\r\n// Built-in Type Documentation\r\n// ============================================================================\r\n\r\nconst BUILTIN_DOCS: Record<string, string> = {\r\n  String: `**String** - UTF-8 text value\r\n\r\nA sequence of Unicode characters. Supports common string operations.\r\n\r\n\\`\\`\\`isl\r\nusername: String\r\n\\`\\`\\``,\r\n\r\n  Int: `**Int** - Integer value\r\n\r\nA 64-bit signed integer. Range: -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807\r\n\r\n\\`\\`\\`isl\r\ncount: Int\r\n\\`\\`\\``,\r\n\r\n  Decimal: `**Decimal** - Arbitrary precision decimal\r\n\r\nUse for monetary values and other precise calculations.\r\n\r\n\\`\\`\\`isl\r\nprice: Decimal\r\n\\`\\`\\``,\r\n\r\n  Boolean: `**Boolean** - Logical value\r\n\r\nEither \\`true\\` or \\`false\\`.\r\n\r\n\\`\\`\\`isl\r\nisActive: Boolean\r\n\\`\\`\\``,\r\n\r\n  UUID: `**UUID** - Universally Unique Identifier\r\n\r\nA 128-bit identifier, typically used for entity IDs.\r\n\r\n\\`\\`\\`isl\r\nid: UUID @unique\r\n\\`\\`\\``,\r\n\r\n  Timestamp: `**Timestamp** - Date and time with timezone\r\n\r\nAn instant in time with nanosecond precision.\r\n\r\n\\`\\`\\`isl\r\ncreatedAt: Timestamp\r\n\\`\\`\\``,\r\n\r\n  Duration: `**Duration** - Time duration\r\n\r\nA length of time. Can be specified in ms, seconds, minutes, hours, days.\r\n\r\n\\`\\`\\`isl\r\ntimeout: Duration = 30.seconds\r\n\\`\\`\\``,\r\n\r\n  Date: `**Date** - Calendar date\r\n\r\nA date without time component.\r\n\r\n\\`\\`\\`isl\r\nbirthDate: Date\r\n\\`\\`\\``,\r\n\r\n  Time: `**Time** - Time of day\r\n\r\nA time without date component.\r\n\r\n\\`\\`\\`isl\r\nstartTime: Time\r\n\\`\\`\\``,\r\n\r\n  List: `**List<T>** - Ordered collection\r\n\r\nAn ordered sequence of elements of type T.\r\n\r\n\\`\\`\\`isl\r\ntags: List<String>\r\norders: List<Order>\r\n\\`\\`\\``,\r\n\r\n  Map: `**Map<K, V>** - Key-value collection\r\n\r\nA collection of key-value pairs with unique keys.\r\n\r\n\\`\\`\\`isl\r\nmetadata: Map<String, String>\r\n\\`\\`\\``,\r\n\r\n  Set: `**Set<T>** - Unique collection\r\n\r\nA collection of unique elements.\r\n\r\n\\`\\`\\`isl\r\ncategories: Set<String>\r\n\\`\\`\\``,\r\n\r\n  Optional: `**Optional<T>** - Nullable value\r\n\r\nA value that may or may not be present. Can also use \\`?\\` suffix.\r\n\r\n\\`\\`\\`isl\r\nmiddleName: Optional<String>\r\n// or\r\nmiddleName: String?\r\n\\`\\`\\``,\r\n};\r\n\r\n// ============================================================================\r\n// Keyword Documentation\r\n// ============================================================================\r\n\r\nconst KEYWORD_DOCS: Record<string, string> = {\r\n  domain: `**domain** - Root container for ISL specification\r\n\r\nA domain defines a bounded context containing entities, behaviors, types, and policies.\r\n\r\n\\`\\`\\`isl\r\ndomain Ecommerce {\r\n  version: \"1.0.0\"\r\n  // ... declarations\r\n}\r\n\\`\\`\\``,\r\n\r\n  entity: `**entity** - Persistent data model\r\n\r\nEntities represent core data structures with identity, state, and behavior.\r\n\r\n\\`\\`\\`isl\r\nentity User {\r\n  id: UUID @unique\r\n  email: Email\r\n  status: UserStatus\r\n  \r\n  invariants {\r\n    email.is_valid()\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  behavior: `**behavior** - Operation with contracts\r\n\r\nBehaviors define operations with input/output types, preconditions, and postconditions.\r\n\r\n\\`\\`\\`isl\r\nbehavior CreateUser {\r\n  input {\r\n    email: Email\r\n    username: String\r\n  }\r\n  \r\n  output {\r\n    success: User\r\n    errors { ... }\r\n  }\r\n  \r\n  preconditions {\r\n    not User.exists_by_email(input.email)\r\n  }\r\n  \r\n  postconditions {\r\n    success implies {\r\n      User.exists(result.id)\r\n    }\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  type: `**type** - Custom type definition\r\n\r\nDefine constrained or aliased types.\r\n\r\n\\`\\`\\`isl\r\ntype Email = String { format: \"email\", max_length: 254 }\r\ntype Money = Decimal { min: 0 }\r\n\\`\\`\\``,\r\n\r\n  enum: `**enum** - Enumeration type\r\n\r\nDefine a set of named values.\r\n\r\n\\`\\`\\`isl\r\nenum UserStatus {\r\n  ACTIVE\r\n  INACTIVE\r\n  SUSPENDED\r\n}\r\n\\`\\`\\``,\r\n\r\n  invariants: `**invariants** - Constraints that must always hold\r\n\r\nDefine business rules that must be maintained across all operations.\r\n\r\n\\`\\`\\`isl\r\ninvariants PositiveBalance {\r\n  scope: global\r\n  \r\n  always {\r\n    forall account: Account =>\r\n      account.balance >= 0\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  preconditions: `**preconditions** - Conditions before operation\r\n\r\nConditions that must be true before the operation executes.\r\n\r\n\\`\\`\\`isl\r\npreconditions {\r\n  User.exists(input.userId)\r\n  input.amount > 0\r\n}\r\n\\`\\`\\``,\r\n\r\n  postconditions: `**postconditions** - Conditions after operation\r\n\r\nConditions guaranteed to be true after successful execution.\r\n\r\n\\`\\`\\`isl\r\npostconditions {\r\n  success implies {\r\n    result.status == Active\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  old: `**old(expr)** - Previous value\r\n\r\nReferences the value of an expression before the operation. Only valid in postconditions.\r\n\r\n\\`\\`\\`isl\r\npostconditions {\r\n  success implies {\r\n    account.balance == old(account.balance) - input.amount\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  result: `**result** - Operation output\r\n\r\nReferences the return value of a successful operation. Only valid in postconditions.\r\n\r\n\\`\\`\\`isl\r\npostconditions {\r\n  success implies {\r\n    result.id != null\r\n    result.createdAt <= now()\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  forall: `**forall** - Universal quantifier\r\n\r\nAsserts a condition holds for all elements in a collection.\r\n\r\n\\`\\`\\`isl\r\nforall user: User => user.email.is_valid()\r\n\\`\\`\\``,\r\n\r\n  exists: `**exists** - Existential quantifier\r\n\r\nAsserts at least one element satisfies a condition.\r\n\r\n\\`\\`\\`isl\r\nexists order: Order => order.status == Pending\r\n\\`\\`\\``,\r\n\r\n  implies: `**implies** - Logical implication\r\n\r\nIf the left side is true, the right side must also be true.\r\n\r\n\\`\\`\\`isl\r\nuser.isAdmin implies user.verified\r\n\\`\\`\\``,\r\n\r\n  temporal: `**temporal** - Timing constraints\r\n\r\nDefine response time and timing requirements.\r\n\r\n\\`\\`\\`isl\r\ntemporal {\r\n  response within 200.ms (p50)\r\n  response within 500.ms (p99)\r\n  eventually within 5.minutes: audit_logged\r\n}\r\n\\`\\`\\``,\r\n\r\n  security: `**security** - Security requirements\r\n\r\nDefine access control, rate limiting, and security constraints.\r\n\r\n\\`\\`\\`isl\r\nsecurity {\r\n  requires: authenticated\r\n  rate_limit 100 per hour per ip_address\r\n}\r\n\\`\\`\\``,\r\n\r\n  scenario: `**scenario** - Test scenario\r\n\r\nDefine test cases using given/when/then structure.\r\n\r\n\\`\\`\\`isl\r\nscenario \"Successful login\" {\r\n  given {\r\n    user = User.create(email: \"test@example.com\")\r\n  }\r\n  when {\r\n    result = Login(email: user.email, password: \"secret\")\r\n  }\r\n  then {\r\n    result.success\r\n    Session.exists(result.sessionId)\r\n  }\r\n}\r\n\\`\\`\\``,\r\n\r\n  lifecycle: `**lifecycle** - Entity state machine\r\n\r\nDefine valid state transitions for an entity.\r\n\r\n\\`\\`\\`isl\r\nlifecycle {\r\n  Created -> Active\r\n  Active -> Suspended\r\n  Suspended -> Active\r\n  Active -> Archived\r\n}\r\n\\`\\`\\``,\r\n};\r\n\r\n// ============================================================================\r\n// Hover Provider\r\n// ============================================================================\r\n\r\nexport class ISLHoverProvider {\r\n  constructor(private documentManager: ISLDocumentManager) {}\r\n\r\n  provideHover(document: TextDocument, position: Position): HoverResult | null {\r\n    const word = this.documentManager.getWordAtPosition(document, position);\r\n    if (!word) return null;\r\n\r\n    const range = this.documentManager.getWordRangeAtPosition(document, position);\r\n\r\n    // Check for built-in type\r\n    if (BUILTIN_DOCS[word]) {\r\n      return { contents: BUILTIN_DOCS[word], range };\r\n    }\r\n\r\n    // Check for keyword\r\n    if (KEYWORD_DOCS[word]) {\r\n      return { contents: KEYWORD_DOCS[word], range };\r\n    }\r\n\r\n    // Check for user-defined symbol\r\n    const symbol = this.documentManager.findSymbol(word);\r\n    if (symbol) {\r\n      return { contents: this.formatSymbolHover(symbol), range };\r\n    }\r\n\r\n    // Check for symbol in current document with more context\r\n    const docSymbols = this.documentManager.getSymbols(document.uri);\r\n    const foundSymbol = this.findSymbolByName(docSymbols, word);\r\n    if (foundSymbol) {\r\n      return { contents: this.formatSymbolInfoHover(foundSymbol), range };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private findSymbolByName(\r\n    symbols: Array<{ name: string; kind: string; detail?: string; documentation?: string; children?: unknown[] }>,\r\n    name: string\r\n  ): { name: string; kind: string; detail?: string; documentation?: string; children?: unknown[] } | undefined {\r\n    for (const sym of symbols) {\r\n      if (sym.name === name) return sym;\r\n      if (sym.children) {\r\n        const found = this.findSymbolByName(sym.children as typeof symbols, name);\r\n        if (found) return found;\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private formatSymbolHover(symbol: { name: string; kind: string; detail?: string; type?: string }): string {\r\n    let md = `**${symbol.kind}** \\`${symbol.name}\\`\\n\\n`;\r\n\r\n    if (symbol.type) {\r\n      md += `**Type:** \\`${symbol.type}\\`\\n\\n`;\r\n    }\r\n\r\n    if (symbol.detail) {\r\n      md += `${symbol.detail}\\n`;\r\n    }\r\n\r\n    return md;\r\n  }\r\n\r\n  private formatSymbolInfoHover(\r\n    symbol: { name: string; kind: string; detail?: string; documentation?: string; children?: unknown[] }\r\n  ): string {\r\n    let md = `**${symbol.kind}** \\`${symbol.name}\\`\\n\\n`;\r\n\r\n    if (symbol.detail) {\r\n      md += `${symbol.detail}\\n\\n`;\r\n    }\r\n\r\n    if (symbol.documentation) {\r\n      md += `${symbol.documentation}\\n\\n`;\r\n    }\r\n\r\n    if (symbol.children && symbol.children.length > 0) {\r\n      const childSymbols = symbol.children as Array<{ name: string; kind: string; detail?: string }>;\r\n      \r\n      // Group children by kind\r\n      const fields = childSymbols.filter(c => c.kind === 'field' || c.kind === 'input' || c.kind === 'output');\r\n      const errors = childSymbols.filter(c => c.kind === 'error');\r\n      const states = childSymbols.filter(c => c.kind === 'lifecycle-state');\r\n\r\n      if (fields.length > 0) {\r\n        md += '**Fields:**\\n';\r\n        for (const field of fields) {\r\n          const typeInfo = field.detail ? `: ${field.detail}` : '';\r\n          md += `- \\`${field.name}\\`${typeInfo}\\n`;\r\n        }\r\n        md += '\\n';\r\n      }\r\n\r\n      if (errors.length > 0) {\r\n        md += '**Errors:**\\n';\r\n        for (const error of errors) {\r\n          md += `- \\`${error.name}\\`${error.detail ? ` - ${error.detail}` : ''}\\n`;\r\n        }\r\n        md += '\\n';\r\n      }\r\n\r\n      if (states.length > 0) {\r\n        md += '**Lifecycle States:**\\n';\r\n        md += states.map(s => `\\`${s.name}\\``).join(' â†’ ') + '\\n';\r\n      }\r\n    }\r\n\r\n    return md;\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Diagnostics Provider\r\n// Provides diagnostics from the analyzer with import-aware and semantic lint support\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Diagnostic, Range, DiagnosticRelatedInformation } from 'vscode-languageserver';\r\nimport { DiagnosticSeverity as LSPDiagnosticSeverity } from 'vscode-languageserver';\r\nimport type { ISLDocumentManager } from '../documents';\r\nimport { ISLDocumentManager as DocManager } from '../documents';\r\nimport type { ISLDiagnostic, SourceLocation } from '@isl-lang/lsp-core';\r\nimport { ISLImportResolver, type ImportResolutionResult, type ExportedSymbol } from './import-resolver';\r\nimport { ISLSemanticLinter } from './semantic-linter';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\nexport interface DiagnosticsResult {\r\n  /** Standard diagnostics from parser and type checker */\r\n  diagnostics: Diagnostic[];\r\n  /** Import resolution result with imported symbols */\r\n  importResolution?: ImportResolutionResult;\r\n}\r\n\r\nexport interface DiagnosticsOptions {\r\n  /** Enable import-aware diagnostics */\r\n  resolveImports?: boolean;\r\n  /** Enable semantic lint warnings */\r\n  semanticLinting?: boolean;\r\n  /** Disabled lint rules */\r\n  disabledRules?: string[];\r\n}\r\n\r\n// ============================================================================\r\n// Diagnostics Provider\r\n// ============================================================================\r\n\r\nexport class ISLDiagnosticsProvider {\r\n  private importResolver: ISLImportResolver;\r\n  private semanticLinter: ISLSemanticLinter;\r\n  private options: DiagnosticsOptions = {\r\n    resolveImports: true,\r\n    semanticLinting: true,\r\n    disabledRules: [],\r\n  };\r\n\r\n  constructor(private documentManager: ISLDocumentManager) {\r\n    this.importResolver = new ISLImportResolver();\r\n    this.semanticLinter = new ISLSemanticLinter();\r\n  }\r\n\r\n  /**\r\n   * Configure diagnostics options\r\n   */\r\n  configure(options: Partial<DiagnosticsOptions>): void {\r\n    this.options = { ...this.options, ...options };\r\n    if (options.disabledRules) {\r\n      this.semanticLinter.configureRules([], options.disabledRules);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get disabled rules\r\n   */\r\n  getDisabledRules(): string[] {\r\n    return this.options.disabledRules || [];\r\n  }\r\n\r\n  /**\r\n   * Get the import resolver (for testing)\r\n   */\r\n  getImportResolver(): ISLImportResolver {\r\n    return this.importResolver;\r\n  }\r\n\r\n  /**\r\n   * Get the semantic linter (for testing)\r\n   */\r\n  getSemanticLinter(): ISLSemanticLinter {\r\n    return this.semanticLinter;\r\n  }\r\n\r\n  /**\r\n   * Get diagnostics for a document\r\n   * This method returns LSP-compatible diagnostics\r\n   */\r\n  provideDiagnostics(document: TextDocument): Diagnostic[] {\r\n    // Ensure document is parsed\r\n    this.documentManager.updateDocument(document, true);\r\n\r\n    // Get diagnostics from the analyzer (lsp-core)\r\n    const islDiagnostics = this.documentManager.getDiagnostics(document.uri);\r\n\r\n    // Convert to LSP diagnostics\r\n    let diagnostics = islDiagnostics.map(d => this.convertDiagnostic(d, document.uri));\r\n\r\n    // Add semantic lint diagnostics if enabled\r\n    if (this.options.semanticLinting) {\r\n      const parsed = this.documentManager.getDocument(document.uri);\r\n      if (parsed?.domain) {\r\n        const lintDiagnostics = this.semanticLinter.lint(parsed.domain, document.uri);\r\n        const lintConverted = lintDiagnostics.map(d => this.convertDiagnostic(d, document.uri));\r\n        \r\n        // Merge diagnostics, preferring ones with data (from our linter)\r\n        diagnostics = this.deduplicateDiagnostics([...diagnostics, ...lintConverted]);\r\n      }\r\n    }\r\n\r\n    // Filter out disabled rules (applies to both lsp-core and our linter)\r\n    const disabledRules = this.options.disabledRules || [];\r\n    if (disabledRules.length > 0) {\r\n      diagnostics = diagnostics.filter(d => \r\n        !d.code || !disabledRules.includes(String(d.code))\r\n      );\r\n    }\r\n\r\n    return diagnostics;\r\n  }\r\n\r\n  /**\r\n   * Deduplicate diagnostics, preferring ones with data field\r\n   */\r\n  private deduplicateDiagnostics(diagnostics: Diagnostic[]): Diagnostic[] {\r\n    const byKey = new Map<string, Diagnostic>();\r\n    \r\n    for (const d of diagnostics) {\r\n      // Create a key based on code and start position\r\n      const key = `${d.code}:${d.range.start.line}:${d.range.start.character}`;\r\n      \r\n      const existing = byKey.get(key);\r\n      if (!existing) {\r\n        byKey.set(key, d);\r\n      } else {\r\n        // Prefer the one with data (more context for quick fixes)\r\n        if (d.data && !existing.data) {\r\n          byKey.set(key, d);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return Array.from(byKey.values());\r\n  }\r\n\r\n  /**\r\n   * Get diagnostics with import resolution (async)\r\n   * Returns both diagnostics and import resolution info\r\n   */\r\n  async provideDiagnosticsWithImports(document: TextDocument): Promise<DiagnosticsResult> {\r\n    // Get base diagnostics\r\n    const diagnostics = this.provideDiagnostics(document);\r\n\r\n    // Skip import resolution if disabled or no domain\r\n    if (!this.options.resolveImports) {\r\n      return { diagnostics };\r\n    }\r\n\r\n    const parsed = this.documentManager.getDocument(document.uri);\r\n    if (!parsed?.domain) {\r\n      return { diagnostics };\r\n    }\r\n\r\n    // Resolve imports\r\n    const importResolution = await this.importResolver.resolveImports(\r\n      document.uri,\r\n      parsed.domain\r\n    );\r\n\r\n    // Add import diagnostics\r\n    for (const importDiag of importResolution.diagnostics) {\r\n      diagnostics.push(this.convertDiagnostic(importDiag, document.uri));\r\n    }\r\n\r\n    return {\r\n      diagnostics,\r\n      importResolution,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Validate type references against imported symbols\r\n   * Returns diagnostics for types that reference imported symbols\r\n   */\r\n  validateImportedReferences(\r\n    document: TextDocument,\r\n    importedSymbols: Map<string, ExportedSymbol>\r\n  ): Diagnostic[] {\r\n    const diagnostics: Diagnostic[] = [];\r\n    const parsed = this.documentManager.getDocument(document.uri);\r\n    if (!parsed?.domain) return diagnostics;\r\n\r\n    // Track which imported symbols are actually used\r\n    const usedImports = new Set<string>();\r\n\r\n    // Check type references in entities\r\n    for (const entity of parsed.domain.entities) {\r\n      for (const field of entity.fields) {\r\n        this.checkTypeReference(field.type, importedSymbols, usedImports, diagnostics, document.uri);\r\n      }\r\n    }\r\n\r\n    // Check type references in behaviors\r\n    for (const behavior of parsed.domain.behaviors) {\r\n      for (const field of behavior.input.fields) {\r\n        this.checkTypeReference(field.type, importedSymbols, usedImports, diagnostics, document.uri);\r\n      }\r\n      this.checkTypeReference(behavior.output.success, importedSymbols, usedImports, diagnostics, document.uri);\r\n    }\r\n\r\n    // Warn about unused imports\r\n    for (const [name, symbol] of importedSymbols) {\r\n      if (!usedImports.has(name)) {\r\n        // Find the import location for this symbol\r\n        const importLocation = this.findImportLocation(parsed.domain, name);\r\n        if (importLocation) {\r\n          diagnostics.push({\r\n            range: DocManager.toRange(importLocation),\r\n            message: `Imported '${name}' is never used`,\r\n            severity: LSPDiagnosticSeverity.Hint,\r\n            code: 'ISL2003',\r\n            source: 'isl-import-resolver',\r\n            data: {\r\n              type: 'unused-import',\r\n              symbolName: name,\r\n              originalName: symbol.name,\r\n            },\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return diagnostics;\r\n  }\r\n\r\n  /**\r\n   * Check a type reference for imported symbol usage\r\n   */\r\n  private checkTypeReference(\r\n    typeDef: unknown,\r\n    importedSymbols: Map<string, ExportedSymbol>,\r\n    usedImports: Set<string>,\r\n    _diagnostics: Diagnostic[],\r\n    _uri: string\r\n  ): void {\r\n    if (!typeDef || typeof typeDef !== 'object') return;\r\n    const t = typeDef as Record<string, unknown>;\r\n\r\n    if (t.kind === 'ReferenceType' && t.name && typeof t.name === 'object') {\r\n      const name = t.name as { parts?: Array<{ name: string; location: SourceLocation }> };\r\n      if (name.parts && name.parts.length > 0) {\r\n        const part = name.parts[0];\r\n        if (part && importedSymbols.has(part.name)) {\r\n          usedImports.add(part.name);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Recurse into container types\r\n    if (t.element) this.checkTypeReference(t.element, importedSymbols, usedImports, _diagnostics, _uri);\r\n    if (t.key) this.checkTypeReference(t.key, importedSymbols, usedImports, _diagnostics, _uri);\r\n    if (t.value) this.checkTypeReference(t.value, importedSymbols, usedImports, _diagnostics, _uri);\r\n    if (t.inner) this.checkTypeReference(t.inner, importedSymbols, usedImports, _diagnostics, _uri);\r\n    if (t.base) this.checkTypeReference(t.base, importedSymbols, usedImports, _diagnostics, _uri);\r\n  }\r\n\r\n  /**\r\n   * Find the import location for a symbol name\r\n   */\r\n  private findImportLocation(domain: { imports: Array<{ items: Array<{ name: { name: string; location: SourceLocation }; alias?: { name: string; location: SourceLocation } }> }> }, name: string): SourceLocation | undefined {\r\n    for (const imp of domain.imports) {\r\n      for (const item of imp.items) {\r\n        const importedName = item.alias?.name || item.name.name;\r\n        if (importedName === name) {\r\n          return item.alias?.location || item.name.location;\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Convert ISL diagnostic to LSP diagnostic\r\n   */\r\n  private convertDiagnostic(d: ISLDiagnostic, documentUri: string): Diagnostic {\r\n    const relatedInfo: DiagnosticRelatedInformation[] | undefined = d.relatedInfo?.map(r => ({\r\n      location: {\r\n        uri: r.location.file !== d.location.file ? this.toFileUri(r.location.file) : documentUri,\r\n        range: DocManager.toRange(r.location),\r\n      },\r\n      message: r.message,\r\n    }));\r\n\r\n    return {\r\n      range: DocManager.toRange(d.location),\r\n      message: d.message,\r\n      severity: d.severity as 1 | 2 | 3 | 4,\r\n      code: d.code,\r\n      source: d.source,\r\n      relatedInformation: relatedInfo,\r\n      data: d.data,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Convert file path to URI if needed\r\n   */\r\n  private toFileUri(filePath: string): string {\r\n    if (filePath.startsWith('file://')) {\r\n      return filePath;\r\n    }\r\n    // Simple conversion - in production would use vscode-uri\r\n    return `file://${filePath.replace(/\\\\/g, '/')}`;\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Import Resolver\r\n// Resolves imports across multiple ISL files\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { SourceLocation, Domain, Import, ImportItem } from '@isl-lang/parser';\r\nimport type { ISLDiagnostic } from '@isl-lang/lsp-core';\r\nimport { DiagnosticSeverity } from '@isl-lang/lsp-core';\r\nimport { URI } from 'vscode-uri';\r\nimport * as path from 'path';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\nexport interface ResolvedImport {\r\n  /** The import statement in the source file */\r\n  importStatement: Import;\r\n  /** The resolved URI of the imported file */\r\n  resolvedUri: string;\r\n  /** Whether the import was successfully resolved */\r\n  resolved: boolean;\r\n  /** The imported items with their resolution status */\r\n  items: ResolvedImportItem[];\r\n  /** Diagnostics related to this import */\r\n  diagnostics: ISLDiagnostic[];\r\n}\r\n\r\nexport interface ResolvedImportItem {\r\n  /** The import item from the AST */\r\n  item: ImportItem;\r\n  /** Whether the item exists in the imported file */\r\n  exists: boolean;\r\n  /** The kind of the exported symbol (entity, type, behavior, etc.) */\r\n  kind?: string;\r\n  /** Location of the definition in the source file */\r\n  definitionLocation?: SourceLocation;\r\n}\r\n\r\nexport interface ExportedSymbol {\r\n  name: string;\r\n  kind: 'entity' | 'type' | 'behavior' | 'invariant' | 'policy' | 'view' | 'enum';\r\n  location: SourceLocation;\r\n  uri: string;\r\n}\r\n\r\nexport interface ImportResolutionResult {\r\n  /** All resolved imports for a document */\r\n  imports: ResolvedImport[];\r\n  /** All diagnostics from import resolution */\r\n  diagnostics: ISLDiagnostic[];\r\n  /** Map of imported names to their source definitions */\r\n  importedSymbols: Map<string, ExportedSymbol>;\r\n}\r\n\r\n// ============================================================================\r\n// Import Resolver\r\n// ============================================================================\r\n\r\nexport class ISLImportResolver {\r\n  /** Cache of exported symbols per file URI */\r\n  private exportCache = new Map<string, Map<string, ExportedSymbol>>();\r\n\r\n  /** File content provider - allows testing without filesystem */\r\n  private fileProvider: (uri: string) => Promise<string | undefined>;\r\n\r\n  /** Domain cache for resolved files */\r\n  private domainCache = new Map<string, Domain | undefined>();\r\n\r\n  constructor(fileProvider?: (uri: string) => Promise<string | undefined>) {\r\n    this.fileProvider = fileProvider || this.defaultFileProvider;\r\n  }\r\n\r\n  /**\r\n   * Resolve all imports in a document\r\n   */\r\n  async resolveImports(\r\n    documentUri: string,\r\n    domain: Domain\r\n  ): Promise<ImportResolutionResult> {\r\n    const result: ImportResolutionResult = {\r\n      imports: [],\r\n      diagnostics: [],\r\n      importedSymbols: new Map(),\r\n    };\r\n\r\n    if (!domain.imports || domain.imports.length === 0) {\r\n      return result;\r\n    }\r\n\r\n    for (const importStmt of domain.imports) {\r\n      const resolvedImport = await this.resolveImport(documentUri, importStmt);\r\n      result.imports.push(resolvedImport);\r\n      result.diagnostics.push(...resolvedImport.diagnostics);\r\n\r\n      // Add successfully imported symbols to the map\r\n      for (const item of resolvedImport.items) {\r\n        if (item.exists && item.definitionLocation) {\r\n          const name = item.item.alias?.name || item.item.name.name;\r\n          result.importedSymbols.set(name, {\r\n            name: item.item.name.name,\r\n            kind: item.kind as ExportedSymbol['kind'],\r\n            location: item.definitionLocation,\r\n            uri: resolvedImport.resolvedUri,\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Resolve a single import statement\r\n   */\r\n  private async resolveImport(\r\n    documentUri: string,\r\n    importStmt: Import\r\n  ): Promise<ResolvedImport> {\r\n    const diagnostics: ISLDiagnostic[] = [];\r\n    const resolvedUri = this.resolveImportPath(documentUri, importStmt.from.value);\r\n\r\n    const result: ResolvedImport = {\r\n      importStatement: importStmt,\r\n      resolvedUri,\r\n      resolved: false,\r\n      items: [],\r\n      diagnostics,\r\n    };\r\n\r\n    // Try to load the imported file\r\n    const importedDomain = await this.loadDomain(resolvedUri);\r\n\r\n    if (!importedDomain) {\r\n      // File not found or parse error\r\n      diagnostics.push({\r\n        message: `Cannot resolve import '${importStmt.from.value}'`,\r\n        severity: DiagnosticSeverity.Error,\r\n        location: importStmt.from.location,\r\n        code: 'ISL2001',\r\n        source: 'isl-import-resolver',\r\n        data: {\r\n          type: 'unresolved-import',\r\n          importPath: importStmt.from.value,\r\n          resolvedUri,\r\n        },\r\n      });\r\n      return result;\r\n    }\r\n\r\n    result.resolved = true;\r\n\r\n    // Get exported symbols from the imported file\r\n    const exports = this.getExports(resolvedUri, importedDomain);\r\n\r\n    // Resolve each imported item\r\n    for (const item of importStmt.items) {\r\n      const exportedSymbol = exports.get(item.name.name);\r\n\r\n      if (!exportedSymbol) {\r\n        // Symbol not found in imported file\r\n        diagnostics.push({\r\n          message: `'${item.name.name}' is not exported from '${importStmt.from.value}'`,\r\n          severity: DiagnosticSeverity.Error,\r\n          location: item.name.location,\r\n          code: 'ISL2002',\r\n          source: 'isl-import-resolver',\r\n          relatedInfo: [\r\n            {\r\n              message: `File '${importStmt.from.value}' exports: ${Array.from(exports.keys()).join(', ') || 'nothing'}`,\r\n              location: importStmt.from.location,\r\n            },\r\n          ],\r\n          data: {\r\n            type: 'unknown-export',\r\n            symbolName: item.name.name,\r\n            availableExports: Array.from(exports.keys()),\r\n          },\r\n        });\r\n\r\n        result.items.push({\r\n          item,\r\n          exists: false,\r\n        });\r\n      } else {\r\n        result.items.push({\r\n          item,\r\n          exists: true,\r\n          kind: exportedSymbol.kind,\r\n          definitionLocation: exportedSymbol.location,\r\n        });\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Get all exported symbols from a domain\r\n   */\r\n  getExports(uri: string, domain: Domain): Map<string, ExportedSymbol> {\r\n    // Check cache first\r\n    const cached = this.exportCache.get(uri);\r\n    if (cached) return cached;\r\n\r\n    const exports = new Map<string, ExportedSymbol>();\r\n\r\n    // Export entities\r\n    for (const entity of domain.entities) {\r\n      exports.set(entity.name.name, {\r\n        name: entity.name.name,\r\n        kind: 'entity',\r\n        location: entity.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Export types\r\n    for (const type of domain.types) {\r\n      const kind = type.definition.kind === 'EnumType' ? 'enum' : 'type';\r\n      exports.set(type.name.name, {\r\n        name: type.name.name,\r\n        kind,\r\n        location: type.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Export behaviors\r\n    for (const behavior of domain.behaviors) {\r\n      exports.set(behavior.name.name, {\r\n        name: behavior.name.name,\r\n        kind: 'behavior',\r\n        location: behavior.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Export invariants\r\n    for (const invariant of domain.invariants) {\r\n      exports.set(invariant.name.name, {\r\n        name: invariant.name.name,\r\n        kind: 'invariant',\r\n        location: invariant.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Export policies\r\n    for (const policy of domain.policies) {\r\n      exports.set(policy.name.name, {\r\n        name: policy.name.name,\r\n        kind: 'policy',\r\n        location: policy.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Export views\r\n    for (const view of domain.views) {\r\n      exports.set(view.name.name, {\r\n        name: view.name.name,\r\n        kind: 'view',\r\n        location: view.name.location,\r\n        uri,\r\n      });\r\n    }\r\n\r\n    // Cache the exports\r\n    this.exportCache.set(uri, exports);\r\n\r\n    return exports;\r\n  }\r\n\r\n  /**\r\n   * Resolve an import path relative to the importing file\r\n   */\r\n  resolveImportPath(documentUri: string, importPath: string): string {\r\n    // Handle different import path formats\r\n    if (importPath.startsWith('./') || importPath.startsWith('../')) {\r\n      // Relative import\r\n      const documentPath = URI.parse(documentUri).fsPath;\r\n      const documentDir = path.dirname(documentPath);\r\n      const resolved = path.resolve(documentDir, importPath);\r\n\r\n      // Add .isl extension if not present\r\n      const withExtension = resolved.endsWith('.isl') ? resolved : `${resolved}.isl`;\r\n      return URI.file(withExtension).toString();\r\n    }\r\n\r\n    // Absolute or package import - for now just treat as relative to workspace\r\n    // In a real implementation, this would look up in node_modules or similar\r\n    const withExtension = importPath.endsWith('.isl') ? importPath : `${importPath}.isl`;\r\n    return URI.file(withExtension).toString();\r\n  }\r\n\r\n  /**\r\n   * Load and parse a domain from a URI\r\n   */\r\n  private async loadDomain(uri: string): Promise<Domain | undefined> {\r\n    // Check cache\r\n    const cached = this.domainCache.get(uri);\r\n    if (cached !== undefined) return cached;\r\n\r\n    try {\r\n      const content = await this.fileProvider(uri);\r\n      if (!content) {\r\n        this.domainCache.set(uri, undefined);\r\n        return undefined;\r\n      }\r\n\r\n      // Use dynamic import to avoid circular dependencies\r\n      const { parse } = await import('@isl-lang/parser');\r\n      const result = parse(content, URI.parse(uri).fsPath);\r\n\r\n      if (result.success && result.domain) {\r\n        this.domainCache.set(uri, result.domain);\r\n        return result.domain;\r\n      }\r\n\r\n      this.domainCache.set(uri, undefined);\r\n      return undefined;\r\n    } catch {\r\n      this.domainCache.set(uri, undefined);\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Default file provider using filesystem\r\n   */\r\n  private async defaultFileProvider(uri: string): Promise<string | undefined> {\r\n    try {\r\n      const fs = await import('fs/promises');\r\n      const filePath = URI.parse(uri).fsPath;\r\n      return await fs.readFile(filePath, 'utf-8');\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear caches for a specific URI or all URIs\r\n   */\r\n  invalidate(uri?: string): void {\r\n    if (uri) {\r\n      this.exportCache.delete(uri);\r\n      this.domainCache.delete(uri);\r\n    } else {\r\n      this.exportCache.clear();\r\n      this.domainCache.clear();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set a custom file provider (useful for testing)\r\n   */\r\n  setFileProvider(provider: (uri: string) => Promise<string | undefined>): void {\r\n    this.fileProvider = provider;\r\n    // Clear caches when provider changes\r\n    this.invalidate();\r\n  }\r\n\r\n  /**\r\n   * Pre-populate domain cache (useful for testing)\r\n   */\r\n  setDomainCache(uri: string, domain: Domain | undefined): void {\r\n    this.domainCache.set(uri, domain);\r\n    if (domain) {\r\n      this.getExports(uri, domain); // Populate export cache too\r\n    }\r\n  }\r\n}\r\n","// ============================================================================\n// ISL Semantic Linter\n// Advanced semantic lint rules with quickfix suggestions\n// ============================================================================\n\nimport type { Domain, Behavior, Entity, TypeDeclaration, Expression } from '@isl-lang/parser';\nimport type { ISLDiagnostic, SourceLocation } from '@isl-lang/lsp-core';\nimport { DiagnosticSeverity } from '@isl-lang/lsp-core';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface LintRule {\n  id: string;\n  name: string;\n  description: string;\n  severity: DiagnosticSeverity;\n  category: 'correctness' | 'best-practice' | 'security' | 'performance' | 'style';\n}\n\nexport interface LintResult {\n  rule: LintRule;\n  diagnostic: ISLDiagnostic;\n}\n\nexport interface QuickfixData {\n  type: string;\n  [key: string]: unknown;\n}\n\n// ============================================================================\n// Lint Rules Registry\n// ============================================================================\n\nexport const LINT_RULES: Record<string, LintRule> = {\n  // Correctness rules\n  'ISL1001': {\n    id: 'ISL1001',\n    name: 'missing-postcondition',\n    description: 'Behavior should have postconditions to verify outcomes',\n    severity: DiagnosticSeverity.Warning,\n    category: 'correctness',\n  },\n  'ISL1002': {\n    id: 'ISL1002',\n    name: 'precondition-without-error',\n    description: 'Behavior has preconditions but no error cases defined',\n    severity: DiagnosticSeverity.Hint,\n    category: 'correctness',\n  },\n  'ISL1003': {\n    id: 'ISL1003',\n    name: 'unused-type',\n    description: 'Type is defined but never used',\n    severity: DiagnosticSeverity.Hint,\n    category: 'style',\n  },\n  'ISL1004': {\n    id: 'ISL1004',\n    name: 'undefined-behavior-reference',\n    description: 'Scenarios reference undefined behavior',\n    severity: DiagnosticSeverity.Error,\n    category: 'correctness',\n  },\n\n  // Best practice rules\n  'ISL1010': {\n    id: 'ISL1010',\n    name: 'missing-description',\n    description: 'Behavior should have a description',\n    severity: DiagnosticSeverity.Hint,\n    category: 'best-practice',\n  },\n  'ISL1011': {\n    id: 'ISL1011',\n    name: 'entity-without-id',\n    description: 'Entity should have an id field for identification',\n    severity: DiagnosticSeverity.Warning,\n    category: 'best-practice',\n  },\n  'ISL1012': {\n    id: 'ISL1012',\n    name: 'mutable-behavior-no-temporal',\n    description: 'State-modifying behavior should specify temporal constraints',\n    severity: DiagnosticSeverity.Hint,\n    category: 'best-practice',\n  },\n  'ISL1013': {\n    id: 'ISL1013',\n    name: 'no-scenarios',\n    description: 'Behavior has no test scenarios defined',\n    severity: DiagnosticSeverity.Hint,\n    category: 'best-practice',\n  },\n\n  // Security rules\n  'ISL1020': {\n    id: 'ISL1020',\n    name: 'sensitive-field-unprotected',\n    description: 'Potentially sensitive field should have constraints',\n    severity: DiagnosticSeverity.Warning,\n    category: 'security',\n  },\n  'ISL1021': {\n    id: 'ISL1021',\n    name: 'no-authentication',\n    description: 'State-modifying behavior has no security requirements',\n    severity: DiagnosticSeverity.Hint,\n    category: 'security',\n  },\n\n  // Performance rules\n  'ISL1030': {\n    id: 'ISL1030',\n    name: 'unbounded-list',\n    description: 'List type without size constraint may cause performance issues',\n    severity: DiagnosticSeverity.Hint,\n    category: 'performance',\n  },\n  'ISL1031': {\n    id: 'ISL1031',\n    name: 'missing-pagination',\n    description: 'Behavior returning a list should consider pagination',\n    severity: DiagnosticSeverity.Hint,\n    category: 'performance',\n  },\n};\n\n// ============================================================================\n// Semantic Linter\n// ============================================================================\n\nexport class ISLSemanticLinter {\n  private enabledRules: Set<string> = new Set(Object.keys(LINT_RULES));\n\n  /**\n   * Enable/disable specific rules\n   */\n  configureRules(enabled: string[], disabled: string[]): void {\n    for (const rule of enabled) {\n      this.enabledRules.add(rule);\n    }\n    for (const rule of disabled) {\n      this.enabledRules.delete(rule);\n    }\n  }\n\n  /**\n   * Lint a domain and return all diagnostics\n   */\n  lint(domain: Domain, filePath: string): ISLDiagnostic[] {\n    const diagnostics: ISLDiagnostic[] = [];\n\n    // Run all lint checks\n    diagnostics.push(...this.lintBehaviors(domain, filePath));\n    diagnostics.push(...this.lintEntities(domain, filePath));\n    diagnostics.push(...this.lintTypes(domain, filePath));\n    diagnostics.push(...this.lintScenarios(domain, filePath));\n    diagnostics.push(...this.lintSecurity(domain, filePath));\n\n    // Filter by enabled rules\n    return diagnostics.filter(d => this.enabledRules.has(d.code || ''));\n  }\n\n  // ============================================================================\n  // Behavior Linting\n  // ============================================================================\n\n  private lintBehaviors(domain: Domain, _filePath: string): ISLDiagnostic[] {\n    const diagnostics: ISLDiagnostic[] = [];\n    const behaviorsWithScenarios = new Set<string>();\n\n    // Collect behaviors that have scenarios\n    for (const scenarioBlock of domain.scenarios) {\n      behaviorsWithScenarios.add(scenarioBlock.behaviorName.name);\n    }\n\n    for (const behavior of domain.behaviors) {\n      // ISL1001: Missing postcondition\n      if (behavior.postconditions.length === 0) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1001']!,\n          `Behavior '${behavior.name.name}' has no postconditions`,\n          behavior.name.location,\n          {\n            type: 'missing-postcondition',\n            behaviorName: behavior.name.name,\n            behaviorLocation: behavior.location,\n          },\n        ));\n      }\n\n      // ISL1002: Precondition without error cases\n      if (behavior.preconditions.length > 0 && behavior.output.errors.length === 0) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1002']!,\n          `Behavior '${behavior.name.name}' has preconditions but no error cases defined`,\n          behavior.name.location,\n          {\n            type: 'precondition-without-error',\n            behaviorName: behavior.name.name,\n            preconditionCount: behavior.preconditions.length,\n          },\n        ));\n      }\n\n      // ISL1010: Missing description\n      if (!behavior.description) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1010']!,\n          `Behavior '${behavior.name.name}' should have a description`,\n          behavior.name.location,\n          {\n            type: 'missing-description',\n            behaviorName: behavior.name.name,\n          },\n        ));\n      }\n\n      // ISL1012: State-modifying behavior without temporal constraints\n      if (this.isStateMutating(behavior) && behavior.temporal.length === 0) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1012']!,\n          `Behavior '${behavior.name.name}' modifies state but has no temporal constraints`,\n          behavior.name.location,\n          {\n            type: 'mutable-behavior-no-temporal',\n            behaviorName: behavior.name.name,\n          },\n        ));\n      }\n\n      // ISL1013: No scenarios\n      if (!behaviorsWithScenarios.has(behavior.name.name)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1013']!,\n          `Behavior '${behavior.name.name}' has no test scenarios defined`,\n          behavior.name.location,\n          {\n            type: 'no-scenarios',\n            behaviorName: behavior.name.name,\n          },\n        ));\n      }\n\n      // ISL1021: No security for state-modifying behaviors\n      if (this.isStateMutating(behavior) && (!behavior.security || behavior.security.length === 0)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1021']!,\n          `Behavior '${behavior.name.name}' modifies state but has no security requirements`,\n          behavior.name.location,\n          {\n            type: 'no-authentication',\n            behaviorName: behavior.name.name,\n          },\n        ));\n      }\n\n      // ISL1031: List return without pagination\n      if (this.returnsList(behavior) && !this.hasPagination(behavior)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1031']!,\n          `Behavior '${behavior.name.name}' returns a list - consider adding pagination`,\n          behavior.output.location,\n          {\n            type: 'missing-pagination',\n            behaviorName: behavior.name.name,\n          },\n        ));\n      }\n    }\n\n    return diagnostics;\n  }\n\n  // ============================================================================\n  // Entity Linting\n  // ============================================================================\n\n  private lintEntities(domain: Domain, _filePath: string): ISLDiagnostic[] {\n    const diagnostics: ISLDiagnostic[] = [];\n\n    for (const entity of domain.entities) {\n      // ISL1011: Entity without id field\n      const hasId = entity.fields.some(f =>\n        f.name.name === 'id' ||\n        f.name.name.toLowerCase().endsWith('id')\n      );\n\n      if (!hasId) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1011']!,\n          `Entity '${entity.name.name}' should have an 'id' field for identification`,\n          entity.name.location,\n          {\n            type: 'entity-without-id',\n            entityName: entity.name.name,\n            fields: entity.fields.map(f => f.name.name),\n          },\n        ));\n      }\n\n      // ISL1020: Sensitive field detection\n      for (const field of entity.fields) {\n        if (this.isSensitiveFieldName(field.name.name)) {\n          const hasConstraints = this.fieldHasConstraints(field);\n          if (!hasConstraints) {\n            diagnostics.push(this.createDiagnostic(\n              LINT_RULES['ISL1020']!,\n              `Field '${field.name.name}' appears sensitive and should have constraints`,\n              field.name.location,\n              {\n                type: 'sensitive-field-unprotected',\n                fieldName: field.name.name,\n                entityName: entity.name.name,\n                suggestedConstraints: this.suggestConstraints(field.name.name),\n              },\n            ));\n          }\n        }\n      }\n    }\n\n    return diagnostics;\n  }\n\n  // ============================================================================\n  // Type Linting\n  // ============================================================================\n\n  private lintTypes(domain: Domain, _filePath: string): ISLDiagnostic[] {\n    const diagnostics: ISLDiagnostic[] = [];\n    const usedTypes = this.collectUsedTypes(domain);\n\n    for (const type of domain.types) {\n      // ISL1003: Unused type\n      if (!usedTypes.has(type.name.name)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1003']!,\n          `Type '${type.name.name}' is defined but never used`,\n          type.name.location,\n          {\n            type: 'unused-type',\n            typeName: type.name.name,\n          },\n        ));\n      }\n\n      // ISL1030: Unbounded list\n      if (this.isUnboundedList(type)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1030']!,\n          `Type '${type.name.name}' is an unbounded list - consider adding max_size constraint`,\n          type.name.location,\n          {\n            type: 'unbounded-list',\n            typeName: type.name.name,\n          },\n        ));\n      }\n    }\n\n    return diagnostics;\n  }\n\n  // ============================================================================\n  // Scenario Linting\n  // ============================================================================\n\n  private lintScenarios(domain: Domain, _filePath: string): ISLDiagnostic[] {\n    const diagnostics: ISLDiagnostic[] = [];\n    const behaviorNames = new Set(domain.behaviors.map(b => b.name.name));\n\n    for (const scenarioBlock of domain.scenarios) {\n      // ISL1004: Undefined behavior reference\n      if (!behaviorNames.has(scenarioBlock.behaviorName.name)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1004']!,\n          `Scenarios reference undefined behavior '${scenarioBlock.behaviorName.name}'`,\n          scenarioBlock.behaviorName.location,\n          {\n            type: 'undefined-behavior-reference',\n            behaviorName: scenarioBlock.behaviorName.name,\n            availableBehaviors: Array.from(behaviorNames),\n          },\n        ));\n      }\n    }\n\n    // Same for chaos scenarios\n    for (const chaosBlock of domain.chaos) {\n      if (!behaviorNames.has(chaosBlock.behaviorName.name)) {\n        diagnostics.push(this.createDiagnostic(\n          LINT_RULES['ISL1004']!,\n          `Chaos tests reference undefined behavior '${chaosBlock.behaviorName.name}'`,\n          chaosBlock.behaviorName.location,\n          {\n            type: 'undefined-behavior-reference',\n            behaviorName: chaosBlock.behaviorName.name,\n            availableBehaviors: Array.from(behaviorNames),\n          },\n        ));\n      }\n    }\n\n    return diagnostics;\n  }\n\n  // ============================================================================\n  // Security Linting\n  // ============================================================================\n\n  private lintSecurity(domain: Domain, _filePath: string): ISLDiagnostic[] {\n    // Security checks are included in behavior linting\n    // This method can be extended for domain-level security analysis\n    return [];\n  }\n\n  // ============================================================================\n  // Helper Methods\n  // ============================================================================\n\n  private createDiagnostic(\n    rule: LintRule,\n    message: string,\n    location: SourceLocation,\n    data: QuickfixData,\n    relatedInfo?: Array<{ message: string; location: SourceLocation }>\n  ): ISLDiagnostic {\n    return {\n      message,\n      severity: rule.severity,\n      location,\n      code: rule.id,\n      source: 'isl-semantic-linter',\n      data,\n      relatedInfo,\n    };\n  }\n\n  private isStateMutating(behavior: Behavior): boolean {\n    // Check if behavior creates, updates, or deletes\n    const name = behavior.name.name.toLowerCase();\n    const mutatingPatterns = [\n      'create', 'update', 'delete', 'remove', 'add', 'set',\n      'modify', 'change', 'assign', 'reset', 'clear',\n    ];\n\n    return mutatingPatterns.some(p => name.includes(p));\n  }\n\n  private returnsList(behavior: Behavior): boolean {\n    const output = behavior.output.success;\n    return output.kind === 'ListType';\n  }\n\n  private hasPagination(behavior: Behavior): boolean {\n    // Check if input has pagination-related fields\n    const paginationFields = ['page', 'limit', 'offset', 'cursor', 'pagesize', 'pagenumber'];\n    return behavior.input.fields.some(f =>\n      paginationFields.includes(f.name.name.toLowerCase())\n    );\n  }\n\n  private isSensitiveFieldName(name: string): boolean {\n    const sensitivePatterns = [\n      'password', 'secret', 'token', 'key', 'credential',\n      'ssn', 'social_security', 'credit_card', 'cc_number',\n      'api_key', 'auth', 'private',\n    ];\n    const lower = name.toLowerCase();\n    return sensitivePatterns.some(p => lower.includes(p));\n  }\n\n  private fieldHasConstraints(field: { type: unknown }): boolean {\n    const type = field.type as Record<string, unknown>;\n    return type?.kind === 'ConstrainedType';\n  }\n\n  private suggestConstraints(fieldName: string): string[] {\n    const lower = fieldName.toLowerCase();\n    if (lower.includes('password')) {\n      return ['min_length: 8', 'pattern: \"^(?=.*[A-Za-z])(?=.*\\\\d).+\"'];\n    }\n    if (lower.includes('email')) {\n      return ['format: \"email\"'];\n    }\n    if (lower.includes('token') || lower.includes('key')) {\n      return ['immutable: true'];\n    }\n    return ['encrypted: true'];\n  }\n\n  private collectUsedTypes(domain: Domain): Set<string> {\n    const usedTypes = new Set<string>();\n\n    const collectFromType = (typeDef: unknown) => {\n      if (!typeDef || typeof typeDef !== 'object') return;\n      const t = typeDef as Record<string, unknown>;\n\n      if (t.kind === 'ReferenceType' && t.name && typeof t.name === 'object') {\n        const name = t.name as { parts?: Array<{ name: string }> };\n        if (name.parts && name.parts.length > 0 && name.parts[0]) {\n          usedTypes.add(name.parts[0].name);\n        }\n      }\n\n      // Recurse into container types\n      if (t.element) collectFromType(t.element);\n      if (t.key) collectFromType(t.key);\n      if (t.value) collectFromType(t.value);\n      if (t.inner) collectFromType(t.inner);\n      if (t.base) collectFromType(t.base);\n    };\n\n    // Collect from entities\n    for (const entity of domain.entities) {\n      for (const field of entity.fields) {\n        collectFromType(field.type);\n      }\n    }\n\n    // Collect from behaviors\n    for (const behavior of domain.behaviors) {\n      for (const field of behavior.input.fields) {\n        collectFromType(field.type);\n      }\n      collectFromType(behavior.output.success);\n    }\n\n    // Collect from types\n    for (const type of domain.types) {\n      if (type.definition.kind === 'StructType') {\n        for (const field of type.definition.fields) {\n          collectFromType(field.type);\n        }\n      } else if (type.definition.kind === 'ConstrainedType') {\n        collectFromType(type.definition.base);\n      }\n    }\n\n    return usedTypes;\n  }\n\n  private isUnboundedList(type: TypeDeclaration): boolean {\n    const def = type.definition;\n    if (def.kind !== 'ConstrainedType') return false;\n\n    const base = def.base as unknown as Record<string, unknown>;\n    if (base.kind !== 'ListType') return false;\n\n    // Check if there's a max_size constraint\n    const hasMaxSize = def.constraints.some(c =>\n      c.name === 'max_size' || c.name === 'max_length'\n    );\n\n    return !hasMaxSize;\n  }\n}\n","// ============================================================================\r\n// ISL Definition Provider (Go to Definition)\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Position, Location } from 'vscode-languageserver';\r\nimport type { ISLDocumentManager } from '../documents';\r\n\r\nexport class ISLDefinitionProvider {\r\n  constructor(private documentManager: ISLDocumentManager) {}\r\n\r\n  provideDefinition(document: TextDocument, position: Position): Location | null {\r\n    const word = this.documentManager.getWordAtPosition(document, position);\r\n    if (!word) return null;\r\n\r\n    // Skip built-in types\r\n    if (this.isBuiltinType(word)) {\r\n      return null;\r\n    }\r\n\r\n    // Find symbol definition in the index\r\n    const symbol = this.documentManager.findSymbol(word);\r\n    if (symbol) {\r\n      return {\r\n        uri: symbol.uri,\r\n        range: {\r\n          start: {\r\n            line: symbol.selectionLocation.line - 1,\r\n            character: symbol.selectionLocation.column - 1,\r\n          },\r\n          end: {\r\n            line: symbol.selectionLocation.endLine - 1,\r\n            character: symbol.selectionLocation.endColumn - 1,\r\n          },\r\n        },\r\n      };\r\n    }\r\n\r\n    // Try to find in current document's symbols\r\n    const docSymbols = this.documentManager.getSymbols(document.uri);\r\n    const found = this.findSymbolByName(docSymbols, word);\r\n    if (found) {\r\n      return {\r\n        uri: document.uri,\r\n        range: {\r\n          start: {\r\n            line: found.selectionLocation.line - 1,\r\n            character: found.selectionLocation.column - 1,\r\n          },\r\n          end: {\r\n            line: found.selectionLocation.endLine - 1,\r\n            character: found.selectionLocation.endColumn - 1,\r\n          },\r\n        },\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private isBuiltinType(name: string): boolean {\r\n    const builtins = new Set([\r\n      'String', 'Int', 'Decimal', 'Boolean', 'UUID', 'Timestamp',\r\n      'Duration', 'Date', 'Time', 'List', 'Map', 'Set', 'Optional', 'Any',\r\n    ]);\r\n    return builtins.has(name);\r\n  }\r\n\r\n  private findSymbolByName(\r\n    symbols: Array<{\r\n      name: string;\r\n      location: { line: number; column: number; endLine: number; endColumn: number };\r\n      selectionLocation: { line: number; column: number; endLine: number; endColumn: number };\r\n      children?: unknown[];\r\n    }>,\r\n    name: string\r\n  ): { selectionLocation: { line: number; column: number; endLine: number; endColumn: number } } | undefined {\r\n    for (const sym of symbols) {\r\n      if (sym.name === name) return sym;\r\n      if (sym.children) {\r\n        const found = this.findSymbolByName(sym.children as typeof symbols, name);\r\n        if (found) return found;\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Document Symbol Provider\r\n// Provides document outline/symbols for the editor\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Range } from 'vscode-languageserver';\r\nimport type { ISLDocumentManager } from '../documents';\r\nimport { ISLDocumentManager as DocManager } from '../documents';\r\nimport type { ISLSymbolInfo, SourceLocation } from '@isl-lang/lsp-core';\r\n\r\nexport interface DocumentSymbol {\r\n  name: string;\r\n  kind: string;\r\n  range: Range;\r\n  selectionRange: Range;\r\n  detail?: string;\r\n  children?: DocumentSymbol[];\r\n}\r\n\r\nexport class ISLSymbolProvider {\r\n  constructor(private documentManager: ISLDocumentManager) {}\r\n\r\n  provideSymbols(document: TextDocument): DocumentSymbol[] {\r\n    // Ensure document is parsed\r\n    this.documentManager.updateDocument(document, true);\r\n\r\n    // Get symbols from the analyzer\r\n    const symbols = this.documentManager.getSymbols(document.uri);\r\n\r\n    // Convert to document symbols\r\n    return symbols.map(sym => this.convertSymbol(sym));\r\n  }\r\n\r\n  private convertSymbol(sym: ISLSymbolInfo): DocumentSymbol {\r\n    return {\r\n      name: sym.name,\r\n      kind: sym.kind,\r\n      range: this.toRange(sym.location),\r\n      selectionRange: this.toRange(sym.selectionLocation),\r\n      detail: sym.detail,\r\n      children: sym.children?.map(child => this.convertSymbol(child)),\r\n    };\r\n  }\r\n\r\n  private toRange(loc: { line: number; column: number; endLine: number; endColumn: number }): Range {\r\n    return {\r\n      start: { line: loc.line - 1, character: loc.column - 1 },\r\n      end: { line: loc.endLine - 1, character: loc.endColumn - 1 },\r\n    };\r\n  }\r\n}\r\n","// ============================================================================\r\n// ISL Semantic Tokens Provider\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { ISLDocumentManager } from '../documents';\r\nimport type { SemanticToken, SemanticTokenType, SemanticTokenModifier } from '../types';\r\n\r\nexport const TOKEN_TYPES: SemanticTokenType[] = [\r\n  'namespace',\r\n  'type',\r\n  'class',\r\n  'enum',\r\n  'interface',\r\n  'struct',\r\n  'typeParameter',\r\n  'parameter',\r\n  'variable',\r\n  'property',\r\n  'enumMember',\r\n  'function',\r\n  'method',\r\n  'keyword',\r\n  'modifier',\r\n  'comment',\r\n  'string',\r\n  'number',\r\n  'regexp',\r\n  'operator',\r\n  'decorator',\r\n];\r\n\r\nexport const TOKEN_MODIFIERS: SemanticTokenModifier[] = [\r\n  'declaration',\r\n  'definition',\r\n  'readonly',\r\n  'static',\r\n  'deprecated',\r\n  'abstract',\r\n  'async',\r\n  'modification',\r\n  'documentation',\r\n  'defaultLibrary',\r\n];\r\n\r\nconst KEYWORDS = new Set([\r\n  'domain', 'entity', 'behavior', 'type', 'invariant', 'policy', 'view', 'scenario',\r\n  'input', 'output', 'pre', 'post', 'error', 'lifecycle', 'temporal', 'security',\r\n  'version', 'description', 'forall', 'exists', 'implies', 'and', 'or', 'not',\r\n  'old', 'result', 'true', 'false', 'null', 'given', 'when', 'then',\r\n]);\r\n\r\nconst BUILTIN_TYPES = new Set([\r\n  'String', 'Int', 'Boolean', 'UUID', 'Timestamp', 'Decimal', 'Duration',\r\n  'Date', 'Time', 'List', 'Map', 'Set', 'Optional',\r\n]);\r\n\r\nexport class ISLSemanticTokensProvider {\r\n  constructor(private documentManager: ISLDocumentManager) {}\r\n\r\n  provideTokens(document: TextDocument): SemanticToken[] {\r\n    const tokens: SemanticToken[] = [];\r\n    const text = document.getText();\r\n    const lines = text.split('\\n');\r\n\r\n    for (let lineNum = 0; lineNum < lines.length; lineNum++) {\r\n      const line = lines[lineNum];\r\n      this.tokenizeLine(line, lineNum, tokens);\r\n    }\r\n\r\n    return tokens;\r\n  }\r\n\r\n  private tokenizeLine(line: string, lineNum: number, tokens: SemanticToken[]): void {\r\n    // Comments\r\n    const commentMatch = line.match(/\\/\\/.*/);\r\n    if (commentMatch) {\r\n      const start = line.indexOf('//');\r\n      tokens.push({\r\n        line: lineNum,\r\n        startChar: start,\r\n        length: line.length - start,\r\n        tokenType: 'comment',\r\n        tokenModifiers: [],\r\n      });\r\n      return; // Don't process rest of line\r\n    }\r\n\r\n    // Strings\r\n    const stringRegex = /\"[^\"]*\"/g;\r\n    let stringMatch;\r\n    while ((stringMatch = stringRegex.exec(line)) !== null) {\r\n      tokens.push({\r\n        line: lineNum,\r\n        startChar: stringMatch.index,\r\n        length: stringMatch[0].length,\r\n        tokenType: 'string',\r\n        tokenModifiers: [],\r\n      });\r\n    }\r\n\r\n    // Numbers\r\n    const numberRegex = /\\b\\d+(\\.\\d+)?\\b/g;\r\n    let numberMatch;\r\n    while ((numberMatch = numberRegex.exec(line)) !== null) {\r\n      tokens.push({\r\n        line: lineNum,\r\n        startChar: numberMatch.index,\r\n        length: numberMatch[0].length,\r\n        tokenType: 'number',\r\n        tokenModifiers: [],\r\n      });\r\n    }\r\n\r\n    // Annotations\r\n    const annotationRegex = /@\\w+/g;\r\n    let annotationMatch;\r\n    while ((annotationMatch = annotationRegex.exec(line)) !== null) {\r\n      tokens.push({\r\n        line: lineNum,\r\n        startChar: annotationMatch.index,\r\n        length: annotationMatch[0].length,\r\n        tokenType: 'decorator',\r\n        tokenModifiers: [],\r\n      });\r\n    }\r\n\r\n    // Keywords and identifiers\r\n    const wordRegex = /\\b[a-zA-Z_]\\w*\\b/g;\r\n    let wordMatch;\r\n    while ((wordMatch = wordRegex.exec(line)) !== null) {\r\n      const word = wordMatch[0];\r\n      const startChar = wordMatch.index;\r\n\r\n      // Skip if already tokenized (in string)\r\n      if (this.isInString(line, startChar)) continue;\r\n\r\n      if (KEYWORDS.has(word)) {\r\n        tokens.push({\r\n          line: lineNum,\r\n          startChar,\r\n          length: word.length,\r\n          tokenType: 'keyword',\r\n          tokenModifiers: [],\r\n        });\r\n      } else if (BUILTIN_TYPES.has(word)) {\r\n        tokens.push({\r\n          line: lineNum,\r\n          startChar,\r\n          length: word.length,\r\n          tokenType: 'type',\r\n          tokenModifiers: ['defaultLibrary'],\r\n        });\r\n      } else if (/^[A-Z]/.test(word)) {\r\n        // Check context for type vs class\r\n        const beforeWord = line.substring(0, startChar).trim();\r\n        if (beforeWord.endsWith('entity') || beforeWord.endsWith('type')) {\r\n          tokens.push({\r\n            line: lineNum,\r\n            startChar,\r\n            length: word.length,\r\n            tokenType: 'class',\r\n            tokenModifiers: ['declaration'],\r\n          });\r\n        } else if (beforeWord.endsWith('behavior')) {\r\n          tokens.push({\r\n            line: lineNum,\r\n            startChar,\r\n            length: word.length,\r\n            tokenType: 'function',\r\n            tokenModifiers: ['declaration'],\r\n          });\r\n        } else if (beforeWord.endsWith(':') || beforeWord.endsWith('<') || beforeWord.endsWith(',')) {\r\n          tokens.push({\r\n            line: lineNum,\r\n            startChar,\r\n            length: word.length,\r\n            tokenType: 'type',\r\n            tokenModifiers: [],\r\n          });\r\n        } else {\r\n          tokens.push({\r\n            line: lineNum,\r\n            startChar,\r\n            length: word.length,\r\n            tokenType: 'class',\r\n            tokenModifiers: [],\r\n          });\r\n        }\r\n      } else if (line.includes(':') && startChar < line.indexOf(':')) {\r\n        // Field name (before colon)\r\n        tokens.push({\r\n          line: lineNum,\r\n          startChar,\r\n          length: word.length,\r\n          tokenType: 'property',\r\n          tokenModifiers: [],\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  private isInString(line: string, position: number): boolean {\r\n    let inString = false;\r\n    for (let i = 0; i < position; i++) {\r\n      if (line[i] === '\"' && (i === 0 || line[i - 1] !== '\\\\')) {\r\n        inString = !inString;\r\n      }\r\n    }\r\n    return inString;\r\n  }\r\n}\r\n","// ============================================================================\n// ISL Code Action Provider\n// Quick fixes and refactoring actions with enhanced quickfix support\n// ============================================================================\n\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\nimport type { Range, CodeActionContext, Diagnostic } from 'vscode-languageserver';\nimport { CodeAction, CodeActionKind, TextEdit } from 'vscode-languageserver';\nimport type { ISLDocumentManager } from '../documents';\nimport { DiagnosticSeverity } from '@isl-lang/lsp-core';\n\n// ============================================================================\n// Quickfix Data Types (from semantic linter)\n// ============================================================================\n\ninterface QuickfixData {\n  type: string;\n  behaviorName?: string;\n  behaviorLocation?: { line: number; column: number; endLine: number; endColumn: number };\n  typeName?: string;\n  entityName?: string;\n  fieldName?: string;\n  symbolName?: string;\n  originalName?: string;\n  availableBehaviors?: string[];\n  availableExports?: string[];\n  suggestedConstraints?: string[];\n  preconditionCount?: number;\n  fields?: string[];\n  [key: string]: unknown;\n}\n\nexport class ISLCodeActionProvider {\n  constructor(private documentManager: ISLDocumentManager) {}\n\n  provideCodeActions(\n    document: TextDocument,\n    range: Range,\n    context: CodeActionContext\n  ): CodeAction[] {\n    const actions: CodeAction[] = [];\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Process diagnostics to generate quick fixes\n    for (const diagnostic of context.diagnostics) {\n      // Extract quickfix data if available\n      const data = diagnostic.data as QuickfixData | undefined;\n\n      // Missing postcondition (ISL1001)\n      if (diagnostic.code === 'ISL1001') {\n        const behaviorName = data?.behaviorName || this.extractBehaviorName(lines, diagnostic.range.start.line);\n        if (behaviorName) {\n          actions.push(this.createAddPostconditionAction(document, diagnostic.range, behaviorName));\n        }\n      }\n\n      // Precondition without error (ISL1002)\n      if (diagnostic.code === 'ISL1002' && data?.behaviorName) {\n        actions.push(this.createAddErrorCaseForPreconditionAction(document, diagnostic.range, data.behaviorName));\n      }\n\n      // Unused type (ISL1003)\n      if (diagnostic.code === 'ISL1003' && data?.typeName) {\n        actions.push(this.createRemoveUnusedTypeAction(document, diagnostic.range, data.typeName));\n      }\n\n      // Undefined behavior reference (ISL1004)\n      if (diagnostic.code === 'ISL1004' && data?.availableBehaviors) {\n        for (const behavior of data.availableBehaviors.slice(0, 3)) {\n          actions.push(this.createRenameToBehaviorAction(document, diagnostic.range, data.behaviorName || '', behavior));\n        }\n      }\n\n      // Missing description (ISL1010)\n      if (diagnostic.code === 'ISL1010' && data?.behaviorName) {\n        actions.push(this.createAddDescriptionAction(document, diagnostic.range, data.behaviorName));\n      }\n\n      // Entity without id (ISL1011)\n      if (diagnostic.code === 'ISL1011' && data?.entityName) {\n        actions.push(this.createAddIdFieldAction(document, diagnostic.range, data.entityName));\n      }\n\n      // No temporal constraints (ISL1012)\n      if (diagnostic.code === 'ISL1012' && data?.behaviorName) {\n        actions.push(this.createAddTemporalAction(document, diagnostic.range, data.behaviorName));\n      }\n\n      // No scenarios (ISL1013)\n      if (diagnostic.code === 'ISL1013' && data?.behaviorName) {\n        actions.push(this.createGenerateScenarioAction(document, data.behaviorName, diagnostic.range));\n      }\n\n      // Sensitive field unprotected (ISL1020)\n      if (diagnostic.code === 'ISL1020' && data?.suggestedConstraints) {\n        actions.push(this.createAddConstraintsAction(document, diagnostic.range, data.fieldName || '', data.suggestedConstraints));\n      }\n\n      // No authentication (ISL1021)\n      if (diagnostic.code === 'ISL1021' && data?.behaviorName) {\n        actions.push(this.createAddSecurityAction(document, diagnostic.range, data.behaviorName));\n      }\n\n      // Unbounded list (ISL1030)\n      if (diagnostic.code === 'ISL1030' && data?.typeName) {\n        actions.push(this.createAddMaxSizeAction(document, diagnostic.range, data.typeName));\n      }\n\n      // Missing pagination (ISL1031)\n      if (diagnostic.code === 'ISL1031' && data?.behaviorName) {\n        actions.push(this.createAddPaginationAction(document, diagnostic.range, data.behaviorName));\n      }\n\n      // Unresolved import (ISL2001)\n      if (diagnostic.code === 'ISL2001') {\n        // Suggest creating the file\n        actions.push(this.createFileAction(document, diagnostic));\n      }\n\n      // Unknown export (ISL2002)\n      if (diagnostic.code === 'ISL2002' && data?.availableExports) {\n        for (const exp of data.availableExports.slice(0, 3)) {\n          actions.push(this.createReplaceImportAction(document, diagnostic.range, data.symbolName || '', exp));\n        }\n      }\n\n      // Unused import (ISL2003)\n      if (diagnostic.code === 'ISL2003') {\n        actions.push(this.createRemoveImportAction(document, diagnostic.range, data?.symbolName || ''));\n      }\n\n      // Unknown type - suggest creating it (legacy)\n      if (diagnostic.code === 'ISL002' || diagnostic.message.includes('Unknown type')) {\n        const typeName = this.extractTypeName(diagnostic.message);\n        if (typeName) {\n          actions.push(this.createDefineTypeAction(document, typeName));\n        }\n      }\n\n      // Naming convention warning\n      if (diagnostic.code === 'ISL009') {\n        const name = this.getWordAtRange(lines, diagnostic.range);\n        if (name) {\n          actions.push(this.createRenameToUppercaseAction(document, diagnostic.range, name));\n        }\n      }\n\n      if (diagnostic.code === 'ISL010') {\n        const name = this.getWordAtRange(lines, diagnostic.range);\n        if (name) {\n          actions.push(this.createRenameToLowercaseAction(document, diagnostic.range, name));\n        }\n      }\n    }\n\n    // Context-based actions (not tied to diagnostics)\n    const lineText = lines[range.start.line] || '';\n    const trimmed = lineText.trim();\n\n    // In a behavior - offer to generate scenario\n    if (this.isInBehavior(lines, range.start.line)) {\n      const behaviorName = this.extractBehaviorName(lines, range.start.line);\n      if (behaviorName) {\n        actions.push(this.createGenerateScenarioAction(document, behaviorName, range));\n      }\n    }\n\n    // In a behavior without output errors - offer to add error case\n    if (trimmed.startsWith('output') || this.isInOutput(lines, range.start.line)) {\n      actions.push(this.createAddErrorCaseAction(document, range));\n    }\n\n    // On entity - offer to generate behavior\n    if (trimmed.match(/^entity\\s+\\w+/)) {\n      const entityName = trimmed.match(/^entity\\s+(\\w+)/)?.[1];\n      if (entityName) {\n        actions.push(this.createGenerateCrudBehaviorsAction(document, entityName, range));\n      }\n    }\n\n    // Generate skeleton from spec â€” available when cursor is inside a domain\n    if (this.isInDomain(lines, range.start.line)) {\n      const domainName = this.extractDomainName(lines);\n      if (domainName) {\n        actions.push(this.createGenerateSkeletonAction(document, domainName));\n      }\n    }\n\n    return actions;\n  }\n\n  // ============================================================================\n  // Quick Fix Actions\n  // ============================================================================\n\n  private createAddPostconditionAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the end of the behavior (before closing brace)\n    let insertLine = range.start.line;\n    let braceDepth = 0;\n    let foundBehavior = false;\n\n    for (let i = range.start.line; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes('behavior ' + behaviorName)) foundBehavior = true;\n      if (foundBehavior) {\n        braceDepth += (line.match(/\\{/g) || []).length;\n        braceDepth -= (line.match(/\\}/g) || []).length;\n        if (braceDepth === 0 && foundBehavior) {\n          insertLine = i;\n          break;\n        }\n      }\n    }\n\n    const indent = '  ';\n    const postconditionBlock = `\n${indent}postconditions {\n${indent}${indent}success implies {\n${indent}${indent}${indent}// Add postcondition assertions here\n${indent}${indent}}\n${indent}}\n`;\n\n    return {\n      title: 'Add postconditions block',\n      kind: CodeActionKind.QuickFix,\n      isPreferred: true,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert(\n              { line: insertLine, character: 0 },\n              postconditionBlock\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createDefineTypeAction(document: TextDocument, typeName: string): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find where to insert (after version, before entities/behaviors)\n    let insertLine = 2;\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.trim().startsWith('entity ') || line.trim().startsWith('behavior ')) {\n        insertLine = i;\n        break;\n      }\n      if (line.trim().startsWith('type ') || line.trim().startsWith('enum ')) {\n        insertLine = i + 1;\n      }\n    }\n\n    const typeDefinition = `\n  type ${typeName} = String {\n    // Add constraints\n  }\n`;\n\n    return {\n      title: `Define type '${typeName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, typeDefinition),\n          ],\n        },\n      },\n    };\n  }\n\n  private createRenameToUppercaseAction(\n    document: TextDocument,\n    range: Range,\n    name: string\n  ): CodeAction {\n    const newName = name.charAt(0).toUpperCase() + name.slice(1);\n    return {\n      title: `Rename to '${newName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [TextEdit.replace(range, newName)],\n        },\n      },\n    };\n  }\n\n  private createRenameToLowercaseAction(\n    document: TextDocument,\n    range: Range,\n    name: string\n  ): CodeAction {\n    const newName = name.charAt(0).toLowerCase() + name.slice(1);\n    return {\n      title: `Rename to '${newName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [TextEdit.replace(range, newName)],\n        },\n      },\n    };\n  }\n\n  // ============================================================================\n  // Refactoring Actions\n  // ============================================================================\n\n  private createGenerateScenarioAction(\n    document: TextDocument,\n    behaviorName: string,\n    range: Range\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find end of domain\n    let insertLine = lines.length - 1;\n    for (let i = lines.length - 1; i >= 0; i--) {\n      const line = lines[i] || '';\n      if (line.trim() === '}') {\n        insertLine = i;\n        break;\n      }\n    }\n\n    const scenarioBlock = `\n  scenarios ${behaviorName} {\n    scenario \"Successful ${behaviorName}\" {\n      given {\n        // Setup initial state\n      }\n\n      when {\n        ${behaviorName}(/* params */)\n      }\n\n      then {\n        result != null\n      }\n    }\n\n    scenario \"${behaviorName} with invalid input\" {\n      given {\n        // Setup state for error case\n      }\n\n      when {\n        ${behaviorName}(/* invalid params */)\n      }\n\n      then {\n        // Error was returned\n      }\n    }\n  }\n`;\n\n    return {\n      title: `Generate test scenarios for ${behaviorName}`,\n      kind: CodeActionKind.Refactor,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, scenarioBlock),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddErrorCaseAction(document: TextDocument, range: Range): CodeAction {\n    const errorCase = `\n      ERROR_NAME {\n        when: \"Error description\"\n        retriable: false\n      }`;\n\n    return {\n      title: 'Add error case',\n      kind: CodeActionKind.Refactor,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert(\n              { line: range.start.line + 1, character: 0 },\n              errorCase\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createGenerateCrudBehaviorsAction(\n    document: TextDocument,\n    entityName: string,\n    range: Range\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find end of domain\n    let insertLine = lines.length - 1;\n    for (let i = lines.length - 1; i >= 0; i--) {\n      const line = lines[i] || '';\n      if (line.trim() === '}') {\n        insertLine = i;\n        break;\n      }\n    }\n\n    const crudBehaviors = `\n  behavior Create${entityName} {\n    description: \"Create a new ${entityName}\"\n\n    input {\n      // Add input fields from ${entityName}\n    }\n\n    output {\n      success: ${entityName}\n\n      errors {\n        VALIDATION_ERROR {\n          when: \"Input validation failed\"\n          retriable: true\n        }\n      }\n    }\n\n    preconditions {\n      // Add preconditions\n    }\n\n    postconditions {\n      success implies {\n        ${entityName}.exists(result.id)\n      }\n    }\n  }\n\n  behavior Get${entityName} {\n    description: \"Get ${entityName} by ID\"\n\n    input {\n      id: UUID\n    }\n\n    output {\n      success: ${entityName}\n\n      errors {\n        NOT_FOUND {\n          when: \"${entityName} does not exist\"\n          retriable: false\n        }\n      }\n    }\n\n    preconditions {\n      id != null\n    }\n\n    postconditions {\n      success implies {\n        result.id == input.id\n      }\n    }\n  }\n\n  behavior Update${entityName} {\n    description: \"Update an existing ${entityName}\"\n\n    input {\n      id: UUID\n      // Add updatable fields\n    }\n\n    output {\n      success: ${entityName}\n\n      errors {\n        NOT_FOUND {\n          when: \"${entityName} does not exist\"\n          retriable: false\n        }\n        VALIDATION_ERROR {\n          when: \"Input validation failed\"\n          retriable: true\n        }\n      }\n    }\n\n    preconditions {\n      ${entityName}.exists(input.id)\n    }\n\n    postconditions {\n      success implies {\n        ${entityName}.lookup(input.id) == result\n      }\n    }\n  }\n\n  behavior Delete${entityName} {\n    description: \"Delete a ${entityName}\"\n\n    input {\n      id: UUID\n    }\n\n    output {\n      success: Boolean\n\n      errors {\n        NOT_FOUND {\n          when: \"${entityName} does not exist\"\n          retriable: false\n        }\n      }\n    }\n\n    preconditions {\n      ${entityName}.exists(input.id)\n    }\n\n    postconditions {\n      success implies {\n        not ${entityName}.exists(input.id)\n      }\n    }\n  }\n`;\n\n    return {\n      title: `Generate CRUD behaviors for ${entityName}`,\n      kind: CodeActionKind.Refactor,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, crudBehaviors),\n          ],\n        },\n      },\n    };\n  }\n\n  // ============================================================================\n  // New Quick Fix Actions for Semantic Linter\n  // ============================================================================\n\n  private createAddErrorCaseForPreconditionAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the output block's errors section or end of output\n    let insertLine = range.start.line;\n    let inBehavior = false;\n    let inOutput = false;\n    let braceDepth = 0;\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`behavior ${behaviorName}`)) inBehavior = true;\n      if (inBehavior) {\n        if (line.trim() === 'output {') inOutput = true;\n        if (inOutput) {\n          braceDepth += (line.match(/\\{/g) || []).length;\n          braceDepth -= (line.match(/\\}/g) || []).length;\n          if (braceDepth === 0) {\n            insertLine = i;\n            break;\n          }\n        }\n      }\n    }\n\n    const errorBlock = `\n      errors {\n        PRECONDITION_FAILED {\n          when: \"Precondition not met\"\n          retriable: false\n        }\n      }\n`;\n\n    return {\n      title: 'Add error case for precondition failure',\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, errorBlock),\n          ],\n        },\n      },\n    };\n  }\n\n  private createRemoveUnusedTypeAction(\n    document: TextDocument,\n    range: Range,\n    typeName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the full type declaration\n    let startLine = range.start.line;\n    let endLine = range.start.line;\n    let braceDepth = 0;\n    let found = false;\n\n    for (let i = startLine; i < lines.length; i++) {\n      const line = lines[i] || '';\n      braceDepth += (line.match(/\\{/g) || []).length;\n      braceDepth -= (line.match(/\\}/g) || []).length;\n      if (braceDepth === 0 && found) {\n        endLine = i;\n        break;\n      }\n      if (braceDepth > 0) found = true;\n    }\n\n    return {\n      title: `Remove unused type '${typeName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.del({\n              start: { line: startLine, character: 0 },\n              end: { line: endLine + 1, character: 0 },\n            }),\n          ],\n        },\n      },\n    };\n  }\n\n  private createRenameToBehaviorAction(\n    document: TextDocument,\n    range: Range,\n    currentName: string,\n    targetName: string\n  ): CodeAction {\n    return {\n      title: `Change to '${targetName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [TextEdit.replace(range, targetName)],\n        },\n      },\n    };\n  }\n\n  private createAddDescriptionAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the line after \"behavior X {\"\n    let insertLine = range.start.line + 1;\n    for (let i = range.start.line; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`behavior ${behaviorName}`) && line.includes('{')) {\n        insertLine = i + 1;\n        break;\n      }\n    }\n\n    return {\n      title: `Add description to '${behaviorName}'`,\n      kind: CodeActionKind.QuickFix,\n      isPreferred: true,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert(\n              { line: insertLine, character: 0 },\n              `    description: \"TODO: Add description for ${behaviorName}\"\\n\\n`\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddIdFieldAction(\n    document: TextDocument,\n    range: Range,\n    entityName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the line after \"entity X {\"\n    let insertLine = range.start.line + 1;\n    for (let i = range.start.line; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`entity ${entityName}`) && line.includes('{')) {\n        insertLine = i + 1;\n        break;\n      }\n    }\n\n    return {\n      title: `Add 'id' field to '${entityName}'`,\n      kind: CodeActionKind.QuickFix,\n      isPreferred: true,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert(\n              { line: insertLine, character: 0 },\n              `    id: UUID\\n`\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddTemporalAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the end of the behavior\n    let insertLine = range.start.line;\n    let braceDepth = 0;\n    let inBehavior = false;\n\n    for (let i = range.start.line; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`behavior ${behaviorName}`)) inBehavior = true;\n      if (inBehavior) {\n        braceDepth += (line.match(/\\{/g) || []).length;\n        braceDepth -= (line.match(/\\}/g) || []).length;\n        if (braceDepth === 0 && inBehavior) {\n          insertLine = i;\n          break;\n        }\n      }\n    }\n\n    const temporalBlock = `\n    temporal {\n      response within 500.ms (p99)\n    }\n`;\n\n    return {\n      title: `Add temporal constraints to '${behaviorName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, temporalBlock),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddConstraintsAction(\n    document: TextDocument,\n    range: Range,\n    fieldName: string,\n    suggestedConstraints: string[]\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n    const line = lines[range.start.line] || '';\n\n    // Find the type after the colon\n    const match = line.match(/:\\s*(\\w+)/);\n    if (!match) {\n      return {\n        title: `Add constraints to '${fieldName}'`,\n        kind: CodeActionKind.QuickFix,\n        edit: { changes: {} },\n      };\n    }\n\n    const constraints = suggestedConstraints.join(', ');\n    const newLine = line.replace(\n      /:\\s*(\\w+)/,\n      `: $1 { ${constraints} }`\n    );\n\n    return {\n      title: `Add security constraints to '${fieldName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.replace(\n              {\n                start: { line: range.start.line, character: 0 },\n                end: { line: range.start.line, character: line.length },\n              },\n              newLine\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddSecurityAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the end of the behavior\n    let insertLine = range.start.line;\n    let braceDepth = 0;\n    let inBehavior = false;\n\n    for (let i = range.start.line; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`behavior ${behaviorName}`)) inBehavior = true;\n      if (inBehavior) {\n        braceDepth += (line.match(/\\{/g) || []).length;\n        braceDepth -= (line.match(/\\}/g) || []).length;\n        if (braceDepth === 0 && inBehavior) {\n          insertLine = i;\n          break;\n        }\n      }\n    }\n\n    const securityBlock = `\n    security {\n      requires authentication\n    }\n`;\n\n    return {\n      title: `Add security requirements to '${behaviorName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, securityBlock),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddMaxSizeAction(\n    document: TextDocument,\n    range: Range,\n    typeName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n    const line = lines[range.start.line] || '';\n\n    // Add max_size constraint to list type\n    const newLine = line.replace(\n      /List<([^>]+)>/,\n      'List<$1> { max_size: 1000 }'\n    );\n\n    return {\n      title: `Add max_size constraint to '${typeName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.replace(\n              {\n                start: { line: range.start.line, character: 0 },\n                end: { line: range.start.line, character: line.length },\n              },\n              newLine\n            ),\n          ],\n        },\n      },\n    };\n  }\n\n  private createAddPaginationAction(\n    document: TextDocument,\n    range: Range,\n    behaviorName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n\n    // Find the input block\n    let insertLine = range.start.line;\n    let inBehavior = false;\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i] || '';\n      if (line.includes(`behavior ${behaviorName}`)) inBehavior = true;\n      if (inBehavior && line.trim() === 'input {') {\n        insertLine = i + 1;\n        break;\n      }\n    }\n\n    const paginationFields = `      page: Int { min: 1, default: 1 }\n      pageSize: Int { min: 1, max: 100, default: 20 }\n`;\n\n    return {\n      title: `Add pagination to '${behaviorName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.insert({ line: insertLine, character: 0 }, paginationFields),\n          ],\n        },\n      },\n    };\n  }\n\n  private createFileAction(document: TextDocument, diagnostic: Diagnostic): CodeAction {\n    return {\n      title: 'Create missing file',\n      kind: CodeActionKind.QuickFix,\n      command: {\n        title: 'Create ISL File',\n        command: 'isl.createFile',\n        arguments: [diagnostic.data],\n      },\n    };\n  }\n\n  private createReplaceImportAction(\n    document: TextDocument,\n    range: Range,\n    currentName: string,\n    targetName: string\n  ): CodeAction {\n    return {\n      title: `Import '${targetName}' instead`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [TextEdit.replace(range, targetName)],\n        },\n      },\n    };\n  }\n\n  private createRemoveImportAction(\n    document: TextDocument,\n    range: Range,\n    symbolName: string\n  ): CodeAction {\n    const text = document.getText();\n    const lines = text.split('\\n');\n    const line = lines[range.start.line] || '';\n\n    // Check if this is the only import item on the line\n    const importMatch = line.match(/imports\\s*\\{([^}]+)\\}/);\n    if (importMatch) {\n      const items = importMatch[1]?.split(',').map(s => s.trim()) || [];\n      if (items.length === 1) {\n        // Remove the entire import line\n        return {\n          title: `Remove unused import '${symbolName}'`,\n          kind: CodeActionKind.QuickFix,\n          edit: {\n            changes: {\n              [document.uri]: [\n                TextEdit.del({\n                  start: { line: range.start.line, character: 0 },\n                  end: { line: range.start.line + 1, character: 0 },\n                }),\n              ],\n            },\n          },\n        };\n      }\n    }\n\n    // Just remove the import item\n    return {\n      title: `Remove unused import '${symbolName}'`,\n      kind: CodeActionKind.QuickFix,\n      edit: {\n        changes: {\n          [document.uri]: [\n            TextEdit.replace(range, ''),\n          ],\n        },\n      },\n    };\n  }\n\n  // ============================================================================\n  // Helper Methods\n  // ============================================================================\n\n  private extractBehaviorName(lines: string[], startLine: number): string | undefined {\n    for (let i = startLine; i >= 0; i--) {\n      const match = lines[i]?.match(/^(\\s*)behavior\\s+(\\w+)/);\n      if (match) return match[2];\n    }\n    return undefined;\n  }\n\n  private extractTypeName(message: string): string | undefined {\n    const match = message.match(/Unknown type '(\\w+)'/);\n    return match?.[1];\n  }\n\n  private getWordAtRange(lines: string[], range: Range): string | undefined {\n    const line = lines[range.start.line];\n    if (!line) return undefined;\n    return line.substring(range.start.character, range.end.character);\n  }\n\n  private isInBehavior(lines: string[], lineNum: number): boolean {\n    let braceDepth = 0;\n    for (let i = lineNum; i >= 0; i--) {\n      const line = lines[i] || '';\n      braceDepth += (line.match(/\\}/g) || []).length;\n      braceDepth -= (line.match(/\\{/g) || []).length;\n      if (line.match(/^(\\s*)behavior\\s+\\w+/) && braceDepth <= 0) {\n        return true;\n      }\n      if (line.match(/^(\\s*)entity\\s+\\w+/) && braceDepth <= 0) {\n        return false;\n      }\n    }\n    return false;\n  }\n\n  private isInOutput(lines: string[], lineNum: number): boolean {\n    let braceDepth = 0;\n    for (let i = lineNum; i >= 0; i--) {\n      const line = lines[i] || '';\n      braceDepth += (line.match(/\\}/g) || []).length;\n      braceDepth -= (line.match(/\\{/g) || []).length;\n      if (line.trim() === 'output {' && braceDepth <= 0) {\n        return true;\n      }\n      if (line.trim() === 'input {' && braceDepth <= 0) {\n        return false;\n      }\n    }\n    return false;\n  }\n\n  private isInDomain(lines: string[], lineNum: number): boolean {\n    for (let i = lineNum; i >= 0; i--) {\n      const line = lines[i] || '';\n      if (line.match(/^\\s*domain\\s+\\w+/)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private extractDomainName(lines: string[]): string | undefined {\n    for (const line of lines) {\n      const match = line.match(/^\\s*domain\\s+(\\w+)/);\n      if (match) return match[1];\n    }\n    return undefined;\n  }\n\n  private createGenerateSkeletonAction(\n    document: TextDocument,\n    domainName: string\n  ): CodeAction {\n    return {\n      title: `Generate implementation skeleton for ${domainName}`,\n      kind: CodeActionKind.Source,\n      command: {\n        title: 'Generate Skeleton from ISL Spec',\n        command: 'shipgate.isl.generateSkeleton',\n        arguments: [document.uri, domainName],\n      },\n    };\n  }\n}\n","// ============================================================================\r\n// ISL Document Formatting Provider\r\n// Consistent formatting for ISL files\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { FormattingOptions } from 'vscode-languageserver';\r\nimport { TextEdit } from 'vscode-languageserver';\r\n\r\nexport class ISLFormattingProvider {\r\n  format(document: TextDocument, options: FormattingOptions): TextEdit[] {\r\n    const text = document.getText();\r\n    const formatted = this.formatSource(text, options);\r\n\r\n    // Only return edit if there are changes\r\n    if (formatted === text) {\r\n      return [];\r\n    }\r\n\r\n    return [\r\n      TextEdit.replace(\r\n        {\r\n          start: { line: 0, character: 0 },\r\n          end: document.positionAt(text.length),\r\n        },\r\n        formatted\r\n      ),\r\n    ];\r\n  }\r\n\r\n  private formatSource(source: string, options: FormattingOptions): string {\r\n    const indent = options.insertSpaces ? ' '.repeat(options.tabSize) : '\\t';\r\n    const lines = source.split('\\n');\r\n    const result: string[] = [];\r\n\r\n    let indentLevel = 0;\r\n    let inComment = false;\r\n    let prevLineWasEmpty = false;\r\n    let prevLineWasOpenBrace = false;\r\n\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const line = lines[i] || '';\r\n      const trimmed = line.trim();\r\n\r\n      // Skip empty lines at start\r\n      if (result.length === 0 && trimmed === '') {\r\n        continue;\r\n      }\r\n\r\n      // Handle multi-line comments (if ISL supports them)\r\n      if (trimmed.startsWith('/*')) inComment = true;\r\n      if (trimmed.endsWith('*/')) inComment = false;\r\n\r\n      // Handle comments\r\n      if (trimmed.startsWith('#') || trimmed.startsWith('//') || inComment) {\r\n        result.push(indent.repeat(indentLevel) + trimmed);\r\n        prevLineWasEmpty = false;\r\n        prevLineWasOpenBrace = false;\r\n        continue;\r\n      }\r\n\r\n      // Decrease indent before closing brace\r\n      if (trimmed.startsWith('}')) {\r\n        indentLevel = Math.max(0, indentLevel - 1);\r\n      }\r\n\r\n      // Handle empty lines - max 1 consecutive\r\n      if (trimmed === '') {\r\n        if (!prevLineWasEmpty && !prevLineWasOpenBrace && result.length > 0) {\r\n          result.push('');\r\n          prevLineWasEmpty = true;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      // Add blank line before top-level declarations (except first)\r\n      const isTopLevel = this.isTopLevelDeclaration(trimmed);\r\n      if (isTopLevel && result.length > 0 && !prevLineWasEmpty && indentLevel <= 1) {\r\n        const prevLine = result[result.length - 1]?.trim() || '';\r\n        if (prevLine !== '' && prevLine !== '{' && !prevLine.startsWith('#')) {\r\n          result.push('');\r\n        }\r\n      }\r\n\r\n      // Format the line\r\n      const formattedLine = this.formatLine(trimmed, indentLevel, indent);\r\n      result.push(formattedLine);\r\n\r\n      // Increase indent after opening brace\r\n      if (trimmed.endsWith('{')) {\r\n        indentLevel++;\r\n        prevLineWasOpenBrace = true;\r\n      } else {\r\n        prevLineWasOpenBrace = false;\r\n      }\r\n\r\n      prevLineWasEmpty = false;\r\n    }\r\n\r\n    // Remove trailing empty lines\r\n    while (result.length > 0 && result[result.length - 1]?.trim() === '') {\r\n      result.pop();\r\n    }\r\n\r\n    // Ensure file ends with newline\r\n    return result.join('\\n') + '\\n';\r\n  }\r\n\r\n  private isTopLevelDeclaration(line: string): boolean {\r\n    return (\r\n      line.startsWith('entity ') ||\r\n      line.startsWith('behavior ') ||\r\n      line.startsWith('type ') ||\r\n      line.startsWith('enum ') ||\r\n      line.startsWith('invariants ') ||\r\n      line.startsWith('invariant ') ||\r\n      line.startsWith('policy ') ||\r\n      line.startsWith('view ') ||\r\n      line.startsWith('scenarios ') ||\r\n      line.startsWith('chaos ')\r\n    );\r\n  }\r\n\r\n  private formatLine(line: string, indentLevel: number, indent: string): string {\r\n    // Apply base indentation\r\n    let formatted = indent.repeat(indentLevel) + line;\r\n\r\n    // Normalize whitespace around operators\r\n    formatted = this.normalizeOperators(formatted);\r\n\r\n    // Normalize colons (field: Type, not field :Type)\r\n    formatted = this.normalizeColons(formatted);\r\n\r\n    // Normalize braces\r\n    formatted = this.normalizeBraces(formatted);\r\n\r\n    // Normalize annotations\r\n    formatted = this.normalizeAnnotations(formatted);\r\n\r\n    return formatted;\r\n  }\r\n\r\n  private normalizeOperators(line: string): string {\r\n    // Preserve indentation\r\n    const match = line.match(/^(\\s*)/);\r\n    const indent = match ? match[1] : '';\r\n    let content = line.trim();\r\n\r\n    // Normalize comparison operators\r\n    content = content.replace(/\\s*==\\s*/g, ' == ');\r\n    content = content.replace(/\\s*!=\\s*/g, ' != ');\r\n    content = content.replace(/\\s*<=\\s*/g, ' <= ');\r\n    content = content.replace(/\\s*>=\\s*/g, ' >= ');\r\n    content = content.replace(/\\s*<\\s*/g, ' < ');\r\n    content = content.replace(/\\s*>\\s*/g, ' > ');\r\n\r\n    // Normalize logical operators\r\n    content = content.replace(/\\s+and\\s+/g, ' and ');\r\n    content = content.replace(/\\s+or\\s+/g, ' or ');\r\n    content = content.replace(/\\s+implies\\s+/g, ' implies ');\r\n\r\n    // Normalize arithmetic operators\r\n    content = content.replace(/\\s*\\+\\s*/g, ' + ');\r\n    content = content.replace(/\\s*-\\s*/g, ' - ');\r\n    content = content.replace(/\\s*\\*\\s*/g, ' * ');\r\n    content = content.replace(/\\s*\\/\\s*/g, ' / ');\r\n\r\n    // Fix generic types (no spaces in <T>)\r\n    content = content.replace(/< /g, '<');\r\n    content = content.replace(/ >/g, '>');\r\n    content = content.replace(/, /g, ', ');\r\n\r\n    // Fix negative numbers and arrows\r\n    content = content.replace(/ - > /g, ' -> ');\r\n    content = content.replace(/ - (\\d)/g, ' -$1');\r\n\r\n    return indent + content;\r\n  }\r\n\r\n  private normalizeColons(line: string): string {\r\n    const match = line.match(/^(\\s*)/);\r\n    const indent = match ? match[1] : '';\r\n    let content = line.trim();\r\n\r\n    // Field declarations: name: Type\r\n    content = content.replace(/(\\w+)\\s*:\\s*/g, '$1: ');\r\n\r\n    // Version/description strings: key: \"value\"\r\n    // Already handled by above\r\n\r\n    return indent + content;\r\n  }\r\n\r\n  private normalizeBraces(line: string): string {\r\n    const match = line.match(/^(\\s*)/);\r\n    const indent = match ? match[1] : '';\r\n    let content = line.trim();\r\n\r\n    // Opening brace on same line as declaration\r\n    content = content.replace(/\\s*\\{\\s*$/, ' {');\r\n\r\n    // Space before opening brace\r\n    content = content.replace(/(\\S)\\{/g, '$1 {');\r\n\r\n    return indent + content;\r\n  }\r\n\r\n  private normalizeAnnotations(line: string): string {\r\n    const match = line.match(/^(\\s*)/);\r\n    const indent = match ? match[1] : '';\r\n    let content = line.trim();\r\n\r\n    // Normalize annotation brackets\r\n    content = content.replace(/\\[\\s+/g, '[');\r\n    content = content.replace(/\\s+\\]/g, ']');\r\n\r\n    // Normalize comma-separated annotations\r\n    content = content.replace(/,\\s*/g, ', ');\r\n    content = content.replace(/,\\s+\\]/g, ']');\r\n\r\n    return indent + content;\r\n  }\r\n}\r\n","// ============================================================================\r\n// Host & Reality-Gap Scanner Diagnostics\r\n// Maps firewall (ShipGate + ISL Studio) verdicts to LSP diagnostics.\r\n// Severity, codes, and messages match CLI output; suppressions/allowlists\r\n// are applied inside the firewall.\r\n// ============================================================================\r\n\r\nimport type { TextDocument } from 'vscode-languageserver-textdocument';\r\nimport type { Diagnostic, Range } from 'vscode-languageserver';\r\nimport { DiagnosticSeverity } from 'vscode-languageserver';\r\nimport type { PolicyViolation } from '@isl-lang/firewall';\r\nimport type { IntegratedGateResult } from '@isl-lang/firewall';\r\nimport { createIntegratedFirewall } from '@isl-lang/firewall';\r\n\r\n// ============================================================================\r\n// Constants â€“ match CLI severity/tier\r\n// ============================================================================\r\n\r\nconst SUPPORTED_EXTENSIONS = new Set(['.ts', '.tsx', '.js', '.jsx']);\r\nconst SOURCE_HOST = 'shipgate-host';\r\nconst SOURCE_REALITY_GAP = 'shipgate-reality-gap';\r\n\r\n// ============================================================================\r\n// Severity mapping: CLI tier/severity â†’ LSP DiagnosticSeverity\r\n// ============================================================================\r\n\r\nfunction tierToLSPSeverity(tier: 'hard_block' | 'soft_block' | 'warn'): DiagnosticSeverity {\r\n  switch (tier) {\r\n    case 'hard_block':\r\n      return DiagnosticSeverity.Error;\r\n    case 'soft_block':\r\n      return DiagnosticSeverity.Warning;\r\n    case 'warn':\r\n      return DiagnosticSeverity.Information;\r\n    default:\r\n      return DiagnosticSeverity.Warning;\r\n  }\r\n}\r\n\r\nfunction severityToLSP(severity: 'critical' | 'high' | 'medium' | 'low'): DiagnosticSeverity {\r\n  switch (severity) {\r\n    case 'critical':\r\n    case 'high':\r\n      return DiagnosticSeverity.Error;\r\n    case 'medium':\r\n      return DiagnosticSeverity.Warning;\r\n    case 'low':\r\n      return DiagnosticSeverity.Information;\r\n    default:\r\n      return DiagnosticSeverity.Warning;\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Range helpers\r\n// ============================================================================\r\n\r\n/** Claim location is 1-based line/column; LSP is 0-based. */\r\nfunction claimLocationToRange(claim: { location: { line: number; column: number; length: number } }): Range {\r\n  const { line, column, length } = claim.location;\r\n  return {\r\n    start: { line: line - 1, character: Math.max(0, column - 1) },\r\n    end: { line: line - 1, character: Math.max(0, column - 1 + length) },\r\n  };\r\n}\r\n\r\n/** Line-only violation (e.g. ISL Studio): claimId is \"line-<num>\". */\r\nfunction lineOnlyRange(document: TextDocument, claimId: string): Range {\r\n  const match = /^line-(\\d+)$/.exec(claimId);\r\n  const line = match ? parseInt(match[1], 10) : 1;\r\n  const lineIndex = Math.max(0, line - 1);\r\n  const text = document.getText().split('\\n')[lineIndex];\r\n  const endChar = text !== undefined ? text.length : 0;\r\n  return {\r\n    start: { line: lineIndex, character: 0 },\r\n    end: { line: lineIndex, character: endChar },\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// Scanner diagnostics provider\r\n// ============================================================================\r\n\r\nexport interface ScannerDiagnosticsOptions {\r\n  projectRoot: string;\r\n  enabled: boolean;\r\n  /** Host scanner (truthpack/reality state) â€“ ghost-route, ghost-env, etc. */\r\n  hostScanner: boolean;\r\n  /** Reality-Gap scanner (code vs truthpack) â€“ same engine, exposed as separate source for filtering */\r\n  realityGapScanner: boolean;\r\n}\r\n\r\nconst DEFAULT_OPTIONS: ScannerDiagnosticsOptions = {\r\n  projectRoot: process.cwd(),\r\n  enabled: true,\r\n  hostScanner: true,\r\n  realityGapScanner: true,\r\n};\r\n\r\nexport class ScannerDiagnosticsProvider {\r\n  private options: ScannerDiagnosticsOptions;\r\n  private firewallInstance: ReturnType<typeof createIntegratedFirewall>;\r\n\r\n  constructor(options: Partial<ScannerDiagnosticsOptions> = {}) {\r\n    this.options = { ...DEFAULT_OPTIONS, ...options };\r\n    this.firewallInstance = createIntegratedFirewall({\r\n      projectRoot: this.options.projectRoot,\r\n      mode: 'observe',\r\n    });\r\n  }\r\n\r\n  configure(options: Partial<ScannerDiagnosticsOptions>): void {\r\n    this.options = { ...this.options, ...options };\r\n    this.firewallInstance = createIntegratedFirewall({\r\n      projectRoot: this.options.projectRoot,\r\n      mode: 'observe',\r\n    });\r\n  }\r\n\r\n  /** Whether this document should be scanned (file type). */\r\n  isSupported(document: TextDocument): boolean {\r\n    const path = uriToFilePath(document.uri);\r\n    const ext = path.includes('.') ? path.slice(path.lastIndexOf('.')) : '';\r\n    return SUPPORTED_EXTENSIONS.has(ext.toLowerCase());\r\n  }\r\n\r\n  /**\r\n   * Run Host + Reality-Gap scanners and return LSP diagnostics.\r\n   * Suppressions and safelists are applied inside the firewall.\r\n   */\r\n  async provideDiagnostics(document: TextDocument): Promise<Diagnostic[]> {\r\n    if (!this.options.enabled || !this.isSupported(document)) {\r\n      return [];\r\n    }\r\n\r\n    const filePath = uriToFilePath(document.uri);\r\n    const projectRoot = this.options.projectRoot || filePath.split(/[/\\\\]/).slice(0, -1).join('/');\r\n\r\n    this.firewallInstance.setMode('observe');\r\n    const result: IntegratedGateResult = await this.firewallInstance.evaluate({\r\n      filePath,\r\n      content: document.getText(),\r\n    });\r\n\r\n    return this.mapResultToDiagnostics(document, result);\r\n  }\r\n\r\n  /**\r\n   * Map firewall verdicts to LSP diagnostics.\r\n   * Severity, code, and message match CLI output.\r\n   */\r\n  private mapResultToDiagnostics(document: TextDocument, result: IntegratedGateResult): Diagnostic[] {\r\n    const diagnostics: Diagnostic[] = [];\r\n    const claimById = new Map(result.claims.map(c => [c.id, c]));\r\n\r\n    for (const v of result.violations) {\r\n      const range = this.rangeForViolation(document, v, claimById);\r\n      const severity = v.severity\r\n        ? severityToLSP(v.severity)\r\n        : tierToLSPSeverity(v.tier);\r\n\r\n      const source = isHostViolation(v.policyId) ? SOURCE_HOST : SOURCE_REALITY_GAP;\r\n\r\n      diagnostics.push({\r\n        range,\r\n        message: v.message,\r\n        severity,\r\n        code: v.policyId,\r\n        source,\r\n        data: {\r\n          suggestion: v.suggestion,\r\n          tier: v.tier,\r\n          quickFixes: v.quickFixes,\r\n        },\r\n      });\r\n    }\r\n\r\n    return diagnostics;\r\n  }\r\n\r\n  private rangeForViolation(\r\n    document: TextDocument,\r\n    v: PolicyViolation,\r\n    claimById: Map<string, { location: { line: number; column: number; length: number } }>\r\n  ): Range {\r\n    const claim = claimById.get(v.claimId);\r\n    if (claim?.location) {\r\n      return claimLocationToRange(claim);\r\n    }\r\n    return lineOnlyRange(document, v.claimId);\r\n  }\r\n}\r\n\r\n/** Ghost-* rules come from truthpack validation = Host scanner; everything else = Reality-Gap (ISL Studio). */\r\nfunction isHostViolation(policyId: string): boolean {\r\n  return (\r\n    policyId === 'ghost-route' ||\r\n    policyId === 'ghost-env' ||\r\n    policyId === 'ghost-import' ||\r\n    policyId === 'ghost-file'\r\n  );\r\n}\r\n\r\nfunction uriToFilePath(uri: string): string {\r\n  if (uri.startsWith('file://')) {\r\n    return uri.slice(7).replace(/%2f/gi, '/').replace(/%5c/gi, '\\\\');\r\n  }\r\n  return uri;\r\n}\r\n\r\nexport { SOURCE_HOST, SOURCE_REALITY_GAP };\r\n","#!/usr/bin/env node\r\n// ============================================================================\r\n// ISL Language Server CLI\r\n// ============================================================================\r\n\r\nimport { ISLServer } from './server';\r\n\r\nconst server = new ISLServer();\r\nserver.start();\r\n\r\nconsole.error('ISL Language Server started');\r\n"],"mappings":"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","names":["CodeActionKind","TextEdit","withExtension","DiagnosticSeverity","BUILTIN_TYPES","TextEdit","DiagnosticSeverity","path","DiagnosticSeverity","CodeActionKind","TextEdit"]}