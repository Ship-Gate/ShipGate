---
description: Require firewall check on every AI code write for production safety
alwaysApply: true
priority: 90
---

# AI Code Safety - Firewall on Write

## Mandate

When you **create or modify** source files (`.ts`, `.js`, `.tsx`, `.jsx`), you MUST ensure the change is safe for production:

1. **Before or immediately after** applying code changes, run the firewall on the modified file(s):
   - Use the MCP tool **`firewall_quick_check`** (or **`firewall_evaluate`** for details) with the file path and the new content.
   - If the project has the ISL MCP server with firewall tools, call it for each modified file.
   - Do **not** consider the edit done until the firewall has been run and the result is allowed.

2. **If the result is NOT allowed** (e.g. `allowed: false`, verdict `NO_SHIP`, or any hard_block/blocker):
   - Do **not** leave the code as-is.
   - Either **revert** the violating change, or **fix** the violation (e.g. remove hardcoded secrets, add auth, remove PII from logs) and re-run the firewall until allowed.

3. **If you cannot call the firewall** (e.g. MCP not configured):
   - Apply the same checks manually: no hardcoded credentials, no auth bypass, no PII in console.log, no ghost routes/imports relative to project truth.
   - Prefer using a proper logger over `console.log` in production code.

## What the Firewall Checks

- Auth bypass, hardcoded credentials, unprotected sensitive routes
- PII in logs, console.log in production code
- Payments/rate-limit/intent policy violations
- Ghost routes, ghost env vars, ghost imports (truthpack)

## Summary

- **Every** AI-written edit to source code must pass the firewall (or equivalent checks) before being considered done.
- **NO_SHIP / not allowed** â†’ fix or revert; do not proceed.

---
*Ensures all AI code is checked for production safety.*
